{"version":3,"sources":["../../../src/components/popupContainer/BPopupContainer.ts"],"names":[],"mappings":"AAAA,SAAa,EAAb,EAAiB,QAAjB,QAAiC,cAAjC;AAEA,SAAgB,eAAhB,EAAiC,CAAjC,EAAoC,UAAU,IAAI,UAAlD,EAA8D,QAA9D,EAAwE,QAAxE,EAAkF,QAAlF,QAAkG,KAAlG;AACA,SAAS,gBAAT,QAAiC,8BAAjC;AAEA,SAAS,eAAT,EAA0B,cAA1B,QAAgD,qBAAhD;AAYA,OAAO,MAAM,OAAO,GAAc,EAAE,CAAC,SAAH,CAAa,QAAb,EAAuB,KAAK,IAAI,KAAK,CAAC,EAAtC,CAA3B;AAEP,OAAO,MAAM,WAAW,GAAG,cAAc,CAAC,OAAD,CAAlC;AAEP,IAAI,EAAE,GAAG,CAAT;;AAEA,SAAS,aAAT,CAAuB,KAAvB,EAAqC,KAArC,EAAkD;AAChD,SAAO,CAAC,CAAC,KAAD,EAAQ;AAAE,IAAA,GAAG,EAAE,KAAK,CAAC,EAAb;AAAiB,IAAA,KAAK,EAAE;AAAE,iBAAW,KAAK,GAAG;AAArB;AAAxB,GAAR,EAA4D,CAAC,CAAC,CAAC,UAAD,EAAa,KAAK,CAAC,UAAnB,EAA+B,KAAK,CAAC,MAArC,CAAF,CAA5D,CAAR;AACD;;AAED,MAAM,eAAe,GAAG,eAAe,CAAC;AACtC,EAAA,IAAI,EAAE,mBADgC;;AAEtC,EAAA,KAAK,GAAA;AACH,UAAM,MAAM,GAAG,QAAQ,CAAU,EAAV,CAAvB;;AACA,aAAS,SAAT,CAAmB,OAAnB,EAAwC;AACtC,YAAM,GAAG,GAAG,EAAE,EAAd;AACA,YAAM,KAAK,GAAG,QAAQ,CAAC;AACrB,QAAA,EAAE,EAAE,GADiB;AAErB,QAAA,MAAM,EAAE,eAFa;AAGrB,QAAA,UAAU,EAAE,gBAAgB,CAAC,OAAO,CAAC,UAAT;AAHP,OAAD,CAAtB;AAKA,MAAA,MAAM,CAAC,IAAP,CAAY,KAAZ;AACA,MAAA,QAAQ,GAAG,IAAX,CAAgB,MAAK;AACnB,QAAA,KAAK,CAAC,MAAN,GAAe,OAAO,CAAC,MAAvB;AACD,OAFD;AAGA,aAAO,MAAK;AACV,QAAA,KAAK,CAAC,MAAN,GAAe,eAAf;AACA,QAAA,UAAU,CAAC,MAAK;AACd,gBAAM,KAAK,GAAG,MAAM,CAAC,SAAP,CAAiB,CAAC,IAAI,CAAC,CAAC,EAAF,KAAS,GAA/B,CAAd;;AACA,cAAI,KAAK,GAAG,CAAZ,EAAe;AACb,YAAA,MAAM,CAAC,MAAP,CAAc,KAAd,EAAqB,CAArB;AACD;AACF,SALS,EAKP,GALO,CAAV;AAMD,OARD;AASD;;AACD,UAAM,KAAK,GAAG,QAAQ,CAAC,MAAO,MAAM,CAAC,MAAP,GAAgB,CAAhB,GAAoB,CAAC,CAA7B,CAAtB;AACA,WAAO;AACL,MAAA,SADK;AAEL,MAAA,MAFK;AAGL,MAAA;AAHK,KAAP;AAKD,GA/BqC;;AAgCtC,EAAA,MAAM,GAAA;AACJ,WAAO,CAAC,CAAC,KAAD,EAAQ;AAAE,MAAA,KAAK,EAAE;AAAE,mBAAW,KAAK;AAAlB;AAAT,KAAR,EAA8C,KAAK,KAAL,GAAa,KAAK,MAAL,CAAY,GAAZ,CAAgB,aAAhB,CAAb,GAA8C,SAA5F,CAAR;AACD;;AAlCqC,CAAD,CAAvC;AAuCA,eAAe,eAAf","sourcesContent":["import { Eq, eq, eqNumber } from 'fp-ts/lib/Eq';\nimport { IO } from 'fp-ts/lib/IO';\nimport { VNode, defineComponent, h, Transition as transition, reactive, computed, nextTick } from 'vue';\nimport { formatTransition } from '../../composables/transition';\nimport { Transition, TransitionClasses } from '../../types/Transition';\nimport { constEmptyArray, removeListItem } from '../../utils/helpers';\n\nexport interface PopupOptions {\n  transition: Transition;\n  render: IO<VNode[]>;\n}\n\nexport interface Popup extends PopupOptions {\n  transition: TransitionClasses;\n  id: number;\n}\n\nexport const eqPopup: Eq<Popup> = eq.contramap(eqNumber, popup => popup.id);\n\nexport const removePopup = removeListItem(eqPopup);\n\nlet id = 0;\n\nfunction generatePopup(popup: Popup, index: number): VNode {\n  return h('div', { key: popup.id, style: { 'z-index': index + 1 } }, [h(transition, popup.transition, popup.render)]);\n}\n\nconst BPopupContainer = defineComponent({\n  name: 'b-popup-container',\n  setup() {\n    const popups = reactive<Popup[]>([]);\n    function showPopup(options: PopupOptions): IO<void> {\n      const nid = id++;\n      const popup = reactive({\n        id: nid,\n        render: constEmptyArray as IO<VNode[]>,\n        transition: formatTransition(options.transition)\n      });\n      popups.push(popup);\n      nextTick().then(() => {\n        popup.render = options.render;\n      });\n      return () => {\n        popup.render = constEmptyArray;\n        setTimeout(() => {\n          const index = popups.findIndex(p => p.id === nid);\n          if (index > 0) {\n            popups.splice(index, 1);\n          }\n        }, 250);\n      };\n    }\n    const rootZ = computed(() => (popups.length ? 1 : -1));\n    return {\n      showPopup,\n      popups,\n      rootZ\n    };\n  },\n  render(): VNode {\n    return h('div', { style: { 'z-index': this.rootZ } }, this.rootZ ? this.popups.map(generatePopup) : undefined);\n  }\n});\n\nexport type PopupContainer = InstanceType<typeof BPopupContainer>;\n\nexport default BPopupContainer;\n"],"sourceRoot":"","file":"BPopupContainer.js"}