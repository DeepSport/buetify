{"version":3,"sources":["../../../../src/components/form/autocomplete/BAutocomplete.ts"],"names":[],"mappings":"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","sourcesContent":["import '../sass/form.sass';\nimport '../../dropdown/dropdown.sass';\nimport './autocomplete.sass';\nimport { Eq } from 'fp-ts/lib/Eq';\nimport { IO } from 'fp-ts/lib/IO';\nimport { StaticUseInputProps } from '../../../composables/input/useInput';\nimport { getUseModelPropsDefinition } from '../../../composables/model/useModel';\nimport { useProxy } from '../../../composables/proxy';\nimport { getEqPropsDefinition } from '../../../composables/shared';\nimport { useThemePropsDefinition } from '../../../composables/theme';\nimport { Toggle } from '../../../composables/toggle';\nimport { constEmptyArray, Extractor, extractProp, toggleListItem } from '../../../utils/helpers';\nimport { DropdownThemeMap } from '../../dropdown';\nimport BDropdown from '../../dropdown/BDropdown';\nimport { isArrowDownEvent, isArrowUpEvent, isEnterEvent, isEscEvent, isTabEvent } from '../../../utils/eventHelpers';\nimport { constant, constVoid, FunctionN, Predicate } from 'fp-ts/lib/function';\nimport BDropdownDivider from '../../dropdown/BDropdownDivider';\nimport BDropdownItem from '../../dropdown/BDropdownItem';\nimport { head, isEmpty, lookup } from 'fp-ts/lib/Array';\nimport { alt, chain, fold, fromNullable, isSome, map, none, Option, some, toUndefined } from 'fp-ts/lib/Option';\nimport { pipe } from 'fp-ts/lib/pipeable';\nimport {\n  defineComponent,\n  PropType,\n  VNode,\n  Ref,\n  shallowRef,\n  computed,\n  onBeforeUpdate,\n  nextTick,\n  toRef,\n  Slots,\n  h\n} from 'vue';\n\nimport { BInput } from '../input';\n\nexport interface AutocompleteItem<T> {\n  id: string;\n  isSelected: boolean;\n  isHovered: boolean;\n  text: string;\n  value: T;\n  index: number;\n}\n\nfunction getActiveDescendentId<T>(selectedItems: T[], itemId: keyof T | ((item: T) => string)): string | undefined {\n  return pipe(\n    selectedItems,\n    head,\n    map(item => extractProp(itemId as any, item) as any),\n    toUndefined\n  );\n}\n\nfunction getAutocompleteItems<T>(\n  items: T[],\n  selectedItems: T[],\n  itemId: keyof T | ((item: T) => string),\n  itemText: keyof T | ((item: T) => string),\n  eq: Eq<T>,\n  hoveredItem: Option<AutocompleteItem<T>>\n): AutocompleteItem<T>[] {\n  return items.map((item, index) => ({\n    id: extractProp(itemId as any, item) as any,\n    isSelected: selectedItems.some(i => eq.equals(i, item)),\n    isHovered: isSome(hoveredItem) ? hoveredItem.value.id === (extractProp(itemId as any, item) as any) : false,\n    text: extractProp(itemText as any, item) as any,\n    value: item,\n    index\n  }));\n}\n\ninterface GetSetSelectedProps<T> {\n  eq: Eq<T>;\n  itemText: any;\n  clearOnSelect: boolean;\n  closeOnSelect: boolean;\n}\n\nfunction getSetSelected<T>(\n  props: GetSetSelectedProps<T>,\n  closeDropdown: IO<void>,\n  inputModel: Ref<string>,\n  selectedItemsModel: Ref<T[]>\n): SetSelected<T> {\n  const toggle = toggleListItem(props.eq);\n  return (item: AutocompleteItem<T>) => {\n    inputModel.value = props.clearOnSelect ? '' : (extractProp(props.itemText, item.value) as any);\n    selectedItemsModel.value = toggle(item.value, selectedItemsModel.value || []);\n    if (props.closeOnSelect) {\n      closeDropdown();\n    }\n  };\n}\n\ninterface SetSelected<T> {\n  (item: AutocompleteItem<T>): void;\n}\n\nfunction getSetHovered<T>(\n  hoveredItem: Ref<Option<AutocompleteItem<T>>>,\n  templateItems: Ref<HTMLElement[]>\n): SetHovered<T> {\n  return (item: AutocompleteItem<T> | undefined) => {\n    const newItem = fromNullable(item);\n    if (isSome(newItem)) {\n      hoveredItem.value = newItem;\n      pipe(\n        newItem,\n        map(item => item.index),\n        chain(index => lookup(index, templateItems.value)),\n        fold(constant(constVoid), li => () => li.focus && li.focus())\n      )();\n    }\n  };\n}\n\ninterface SetHovered<T> {\n  (item?: AutocompleteItem<T> | undefined): void;\n}\n\nfunction getOnKeydown<T>(\n  autocompleteItems: Ref<AutocompleteItem<T>[]>,\n  hoveredItem: Ref<Option<AutocompleteItem<T>>>,\n  closeDropdown: IO<void>,\n  setSelected: FunctionN<[AutocompleteItem<T>], void>,\n  setHovered: FunctionN<[AutocompleteItem<T>], void>\n) {\n  function onArrowPress(isUp: boolean) {\n    pipe(\n      hoveredItem.value,\n      map(item => item.index),\n      alt(() => some(0)),\n      chain(index =>\n        lookup(\n          isUp ? Math.max(index - 1, 0) : Math.min(index + 1, autocompleteItems.value.length - 1),\n          autocompleteItems.value as AutocompleteItem<T>[]\n        )\n      ),\n      fold(constant(constVoid), newItem => () => setHovered(newItem))\n    )();\n  }\n  return function onKeydown(event: KeyboardEvent) {\n    if (isEnterEvent(event)) {\n      event.preventDefault();\n      if (isSome(hoveredItem.value)) {\n        setSelected(hoveredItem.value.value);\n      }\n    } else if (isTabEvent(event)) {\n      event.preventDefault();\n      if (isSome(hoveredItem.value)) {\n        setSelected(hoveredItem.value.value);\n      } else {\n        nextTick(closeDropdown);\n      }\n    } else if (isArrowUpEvent(event)) {\n      event.preventDefault();\n      onArrowPress(true);\n    } else if (isArrowDownEvent(event)) {\n      event.preventDefault();\n      onArrowPress(false);\n    } else if (isEscEvent(event)) {\n      event.preventDefault();\n      nextTick(closeDropdown);\n    }\n  };\n}\n\ntype OnKeydown = ReturnType<typeof getOnKeydown>;\n\nfunction getGenerateItem<T>(\n  itemsRef: Ref<HTMLElement[]>,\n  length: Ref<number>,\n  onKeydown: OnKeydown,\n  setSelected: SetSelected<T>,\n  setHovered: SetHovered<T>,\n  slots: Slots\n) {\n  return function generateItem(item: AutocompleteItem<T>, index: number): VNode {\n    return h(\n      BDropdownItem,\n      {\n        key: item.id,\n        ref: (el: any) => {\n          itemsRef.value[index] = el;\n        },\n        id: item.id,\n        isActive: item.isSelected,\n        tabindex: item.isSelected ? -1 : 0,\n        'aria-selected': item.isSelected,\n        'aria-label': `Option ${index + 1} of ${length.value}`,\n        class: { 'is-hovered': item.isHovered },\n        onClick: () => setSelected(item),\n        onMouseenter: () => setHovered(item),\n        onKeydown\n      },\n      () => (slots.default ? slots.default({ option: item, index }) : item.text)\n    );\n  };\n}\n\nfunction generateHeaderItem(slots: Slots): VNode {\n  return h('li', { class: 'dropdown-item', tabindex: -1 }, slots.header && slots.header());\n}\n\nfunction generateFooterItem(slots: Slots): VNode {\n  return h('li', { class: 'dropdown-item', tabindex: -1 }, slots.footer && slots.footer());\n}\n\nfunction generateLoadingItem(slots: Slots): VNode {\n  return h('li', { tabindex: -1 }, [\n    h(BDropdownItem, { tag: 'div' }, () => (slots.loading ? slots.loading() : 'Loading results...'))\n  ]);\n}\n\nfunction generateEmptyItem(modelValue: string | undefined, slots: Slots) {\n  return h(\n    BDropdownItem,\n    {\n      class: 'is-disabled'\n    },\n    () =>\n      slots.empty\n        ? slots.empty({ searchValue: modelValue })\n        : modelValue\n        ? `No results`\n        : `No results for ${modelValue}`\n  );\n}\n\nfunction defineAutocomplete<T>() {\n  return defineComponent({\n    name: 'b-autocomplete',\n    props: {\n      ...StaticUseInputProps,\n      ...getEqPropsDefinition<T>(),\n      ...useThemePropsDefinition(DropdownThemeMap),\n      ...getUseModelPropsDefinition<string>(),\n      ...getUseModelPropsDefinition<T[], 'selectedItems', 'onUpdate:selectedItems'>(\n        'selectedItems',\n        'onUpdate:selectedItems'\n      ),\n      selectedItems: {\n        type: Array as PropType<T[]>,\n        required: true as const\n      },\n      items: {\n        type: Array as PropType<T[]>,\n        default: constEmptyArray\n      },\n      itemFilter: {\n        type: Function as PropType<FunctionN<[string], Predicate<T>>>,\n        required: false\n      },\n      itemId: {\n        type: [String, Function] as PropType<keyof T | ((item: T) => string)>,\n        default: 'id'\n      },\n      itemText: {\n        type: [String, Function] as PropType<keyof T | ((item: T) => string)>,\n        default: 'text'\n      },\n      closeOnSelect: {\n        type: Boolean as PropType<boolean>,\n        default: true\n      },\n      clearOnSelect: {\n        type: Boolean as PropType<boolean>,\n        default: true\n      },\n      openOnFocus: {\n        type: Boolean as PropType<boolean>,\n        default: true\n      },\n      onSelected: {\n        type: Function as PropType<FunctionN<[T], void>>,\n        required: false\n      }\n    },\n    setup(props, { slots }) {\n      const { value: searchValue } = useProxy(\n        computed(() => props.modelValue ?? ''),\n        toRef(props, 'onUpdate:modelValue')\n      );\n      const { value: selectedItems } = useProxy(toRef(props, 'selectedItems'), toRef(props, 'onUpdate:selectedItems'));\n\n      const itemsRef = shallowRef([] as HTMLElement[]);\n      const filteredItems = computed(() => {\n        if (props.itemFilter) {\n          return props.items.filter(props.itemFilter(searchValue.value));\n        } else {\n          const sv = searchValue.value.toLowerCase();\n          const extract = props.itemText;\n          return props.items.filter(i =>\n            ((extractProp(extract as Extractor<T>, i) as unknown) as string).toLowerCase().includes(sv)\n          );\n        }\n      });\n      onBeforeUpdate(() => {\n        itemsRef.value = [];\n      });\n      const dropdown: Ref<InstanceType<typeof BDropdown> | null> = shallowRef(null);\n      function close() {\n        dropdown.value && dropdown.value.toggle.setOff();\n      }\n      const hoveredItem = shallowRef(none as Option<AutocompleteItem<T>>);\n      const activeDescendentId = computed(() => getActiveDescendentId(props.selectedItems, props.itemId as any));\n      const autocompleteItems = computed(() =>\n        getAutocompleteItems(\n          filteredItems.value,\n          selectedItems.value,\n          props.itemId as any,\n          props.itemText as any,\n          props.eq,\n          hoveredItem.value\n        )\n      );\n      const numberOfItems = computed(() => autocompleteItems.value.length);\n      const setSelected = getSetSelected(props, close, searchValue, selectedItems);\n      const setHovered = getSetHovered(hoveredItem, itemsRef);\n      const onKeydown = getOnKeydown(autocompleteItems, hoveredItem, close, setSelected, setHovered);\n      const generateItem = getGenerateItem(itemsRef, numberOfItems, onKeydown, setSelected, setHovered, slots);\n      return () => {\n        return h(\n          BDropdown,\n          {\n            ref: dropdown,\n            isMobileModal: false,\n            class: ['b-autocomplete', { 'is-expanded': props.isExpanded }]\n          },\n          {\n            trigger: (toggle: Toggle) => {\n              return h(BInput, {\n                modelValue: searchValue.value,\n                type: 'text',\n                size: props.size,\n                isLoading: props.isLoading,\n                isRounded: props.isRounded,\n                icon: props.icon,\n                maxlength: props.maxlength,\n                autocomplete: 'off',\n                placeholder: props.placeholder,\n                role: 'searchbox',\n                'aria-activedescendant': activeDescendentId.value,\n                'onUpdate:modelValue': (val: string) => {\n                  searchValue.value = val;\n                },\n                // onFocus: () => {\n                //   nextTick().then(() => {\n                //     if (props.openOnFocus && toggle.isOff.value) {\n                //       toggle.setOn();\n                //     }\n                //   });\n                // },\n                onBlur: props.onBlur,\n                onKeydown\n              });\n            },\n            default: () => {\n              let nodes: VNode[];\n              if (props.isLoading) {\n                nodes = [generateLoadingItem(slots)];\n              } else {\n                nodes = isEmpty(autocompleteItems.value)\n                  ? [generateEmptyItem(searchValue.value, slots)]\n                  : autocompleteItems.value.map(generateItem);\n                if (slots.header) {\n                  nodes.unshift(generateHeaderItem(slots), h(BDropdownDivider));\n                }\n                if (slots.footer) {\n                  nodes.push(h(BDropdownDivider), generateFooterItem(slots));\n                }\n              }\n              return nodes;\n            }\n          }\n        );\n      };\n    }\n  });\n}\n\nexport const BAutocomplete = defineAutocomplete<any>();\n"],"sourceRoot":"","file":"BAutocomplete.js"}