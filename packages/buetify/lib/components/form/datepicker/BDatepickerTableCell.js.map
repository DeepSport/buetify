{"version":3,"sources":["../../../../src/components/form/datepicker/BDatepickerTableCell.ts"],"names":[],"mappings":"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","sourcesContent":["import './datepicker.sass';\nimport { FunctionN } from 'fp-ts/lib/function';\nimport { toggleListItem } from '../../../utils/helpers';\nimport { DateCell, DetailedDateEvent, EventIndicator } from './shared';\nimport { eqSerialDate, isSameDay } from './utils';\nimport { exists, getEq, Option, some } from 'fp-ts/lib/Option';\nimport { pipe } from 'fp-ts/lib/pipeable';\nimport { PropType, VNode, defineComponent, shallowRef, h, watch, onMounted } from 'vue';\n\nfunction generateEvents(events: DetailedDateEvent[]): VNode {\n  return h(\n    'div',\n    { class: 'events' },\n    events.map((event, index) =>\n      h('div', {\n        key: index,\n        class: ['event', event.variant]\n      })\n    )\n  );\n}\n\nconst toggleSerialDate = toggleListItem(eqSerialDate);\n\nconst eqOptionSerialDate = getEq(eqSerialDate);\n\nexport default defineComponent({\n  name: 'b-datepicker-table-cell',\n  props: {\n    modelValue: {\n      type: [Date, Array] as PropType<Date | Date[]>\n    },\n    'onUpdate:modelValue': {\n      type: Function as PropType<FunctionN<[Date | Date[]], void>>,\n      required: true\n    },\n    focusedDate: {\n      type: Object as PropType<Option<Date>>,\n      required: true\n    },\n    'onUpdate:focusedDate': {\n      type: Function as PropType<FunctionN<[Option<Date>], void>>,\n      required: true\n    },\n    indicators: {\n      type: String as PropType<EventIndicator>,\n      required: true\n    },\n    cell: {\n      type: Object as PropType<DateCell>,\n      required: true\n    }\n  },\n  setup(props) {\n    const buttonRef = shallowRef((null as unknown) as HTMLElement);\n\n    function onClick(e?: MouseEvent) {\n      e && e.preventDefault();\n      const currentValue = props.modelValue;\n      props['onUpdate:modelValue'](\n        Array.isArray(currentValue) ? toggleSerialDate(props.cell.date, currentValue) : props.cell.date\n      );\n    }\n\n    const onFocus = () => {\n      props['onUpdate:focusedDate'](some(props.cell.date));\n    };\n\n    onMounted(() =>\n      watch(\n        () => props.focusedDate,\n        (newVal, oldVal) => {\n          if (\n            ((oldVal && !eqOptionSerialDate.equals(newVal, oldVal)) || oldVal === undefined) &&\n            buttonRef.value &&\n            pipe(\n              newVal,\n              exists(d => isSameDay(d, props.cell.date))\n            ) &&\n            document.activeElement !== buttonRef.value\n          ) {\n            buttonRef.value.focus({ preventScroll: true });\n          }\n        },\n        {\n          immediate: true\n        }\n      )\n    );\n\n    return () => {\n      return h('td', [\n        h(\n          'button',\n          {\n            ref: buttonRef,\n            class: ['datepicker-cell', props.cell.classes, props.indicators],\n            disabled: props.cell.isDisabled,\n            tabindex: props.cell.isDisabled || props.cell.isSelected ? -1 : 0,\n            'aria-label': props.cell.ariaLabel,\n            onClick,\n            onFocus,\n            onMouseenter: onFocus\n          },\n          [props.cell.date.getDate(), props.cell.hasEvents ? generateEvents(props.cell.events) : undefined]\n        )\n      ]);\n    };\n  }\n});\n"],"sourceRoot":"","file":"BDatepickerTableCell.js"}