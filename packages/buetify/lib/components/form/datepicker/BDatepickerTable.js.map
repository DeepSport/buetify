{"version":3,"sources":["../../../../src/components/form/datepicker/BDatepickerTable.ts"],"names":[],"mappings":"AAAA,OAAO,4DAAP;AACA,SAAoB,iBAApB,EAAuC,mBAAvC,QAA+E,UAA/E;AACA,SACE,OADF,EAEE,cAFF,EAGE,aAHF,EAIE,YAJF,EAKE,eALF,EAME,cANF,EAOE,MAPF,EAQE,eARF,EASE,gBATF,EAUE,YAVF,QAYO,SAZP;AAaA,SAAS,eAAT,QAAgC,wBAAhC;AACA,SAAS,OAAT,EAAkB,MAAlB,QAAgC,iBAAhC;AACA,SAAS,QAAT,QAAoC,oBAApC;AACA,SAAS,YAAT,EAAuB,MAAvB,EAA+B,IAA/B,QAAmD,kBAAnD;AACA,SAAS,eAAT,EAA6D,CAA7D,EAAgE,QAAhE,QAAqF,KAArF;AACA,OAAO,mBAAP,MAAgC,uBAAhC;AAEA,OAAO,MAAM,+BAA+B,GAAG;AAC7C,EAAA,UAAU,EAAE;AACV,IAAA,IAAI,EAAE,CAAC,KAAD,EAAQ,IAAR;AADI,GADiC;AAI7C,yBAAuB;AACrB,IAAA,IAAI,EAAE,QADe;AAErB,IAAA,QAAQ,EAAE;AAFW,GAJsB;AAQ7C,EAAA,WAAW,EAAE;AACX,IAAA,IAAI,EAAE,MADK;AAEX,IAAA,QAAQ,EAAE;AAFC,GARgC;AAY7C,0BAAwB;AACtB,IAAA,IAAI,EAAE,QADgB;AAEtB,IAAA,QAAQ,EAAE;AAFY,GAZqB;AAgB7C,EAAA,KAAK,EAAE;AACL,IAAA,IAAI,EAAE,MADD;AAEL,IAAA,QAAQ,EAAE;AAFL,GAhBsC;AAoB7C,EAAA,IAAI,EAAE;AACJ,IAAA,IAAI,EAAE,MADF;AAEJ,IAAA,QAAQ,EAAE;AAFN,GApBuC;AAwB7C,EAAA,QAAQ,EAAE;AACR,IAAA,IAAI,EAAE,KADE;AAER,IAAA,OAAO,EAAE,QAAQ,CAAC,iBAAD;AAFT,GAxBmC;AA4B7C,EAAA,UAAU,EAAE;AACV,IAAA,IAAI,EAAE,KADI;AAEV,IAAA,OAAO,EAAE,QAAQ,CAAC,mBAAD;AAFP,GA5BiC;AAgC7C,EAAA,cAAc,EAAE;AACd,IAAA,IAAI,EAAE,MADQ;AAEd,IAAA,OAAO,EAAE;AAFK,GAhC6B;AAoC7C,EAAA,MAAM,EAAE;AACN,IAAA,IAAI,EAAE,KADA;AAEN,IAAA,OAAO,EAAE;AAFH,GApCqC;AAwC7C,EAAA,UAAU,EAAE;AACV,IAAA,IAAI,EAAE,MADI;AAEV,IAAA,QAAQ,EAAE;AAFA,GAxCiC;AA4C7C,EAAA,OAAO,EAAE;AACP,IAAA,IAAI,EAAE,IADC;AAEP,IAAA,QAAQ,EAAE;AAFH,GA5CoC;AAgD7C,EAAA,OAAO,EAAE;AACP,IAAA,IAAI,EAAE,IADC;AAEP,IAAA,QAAQ,EAAE;AAFH,GAhDoC;AAoD7C,EAAA,UAAU,EAAE;AACV,IAAA,IAAI,EAAE,OADI;AAEV,IAAA,OAAO,EAAE;AAFC,GApDiC;AAwD7C,EAAA,iBAAiB,EAAE;AACjB,IAAA,IAAI,EAAE,KADW;AAEjB,IAAA,OAAO,EAAE;AAFQ,GAxD0B;AA4D7C,EAAA,sBAAsB,EAAE;AACtB,IAAA,IAAI,EAAE,KADgB;AAEtB,IAAA,OAAO,EAAE;AAFa,GA5DqB;AAgE7C,EAAA,eAAe,EAAE;AACf,IAAA,IAAI,EAAE;AADS,GAhE4B;AAmE7C,EAAA,cAAc,EAAE;AACd,IAAA,IAAI,EAAE,OADQ;AAEd,IAAA,OAAO,EAAE;AAFK;AAnE6B,CAAxC;;AAiFP,SAAS,mBAAT,CAA6B,KAA7B,EAAyD;AACvD,QAAM,YAAY,GAAG,eAAe,CAAC,IAAI,IAAJ,CAAS,KAAK,CAAC,IAAf,EAAqB,KAAK,CAAC,KAAN,GAAc,CAAnC,EAAsC,CAAtC,CAAD,CAApC;AACA,QAAM,aAAa,GAAG,YAAY,CAAC,aAAa,CAAC,YAAD,CAAd,EAA8B,KAAK,CAAC,cAApC,CAAlC;AACA,QAAM,KAAK,GAAa,EAAxB;AACA,MAAI,IAAI,GAAG,cAAc,CAAC,YAAD,EAAe,KAAK,CAAC,cAArB,CAAzB;;AAEA,SAAO,gBAAgB,CAAC,IAAD,EAAO,aAAP,CAAvB,EAA8C;AAC5C,IAAA,KAAK,CAAC,IAAN,CAAW,cAAc,CAAC,IAAD,EAAO,KAAK,CAAC,cAAb,CAAzB;AACA,IAAA,IAAI,GAAG,OAAO,CAAC,IAAD,EAAO,CAAP,CAAd;AACD;;AACD,SAAO,KAAP;AACD;;AAED,SAAS,mBAAT,CAA6B,KAA7B,EAA2D,IAA3D,EAAuE;AACrE,SAAO,KAAK,CAAC,MAAN,CAAa,MAAb,CAAoB,KAAK,IAAG;AACjC,UAAM,SAAS,GAAG,MAAM,CAAC,KAAD,CAAN,GAAgB,KAAhB,GAAwB,KAAK,CAAC,IAAhD;AACA,WAAO,YAAY,CAAC,IAAI,CAAC,CAAD,CAAL,EAAU,SAAV,EAAqB,KAAK,CAAC,cAA3B,CAAnB;AACD,GAHM,CAAP;AAID;;AAED,SAAS,QAAT,CAAkB,KAAlB,EAA8C;AAC5C,SAAO,mBAAmB,CAAC,KAAD,CAAnB,CAA2B,GAA3B,CAA+B,CAAC,IAAD,EAAO,UAAP,MAAuB;AAC3D,IAAA,IAD2D;AAE3D,IAAA,UAF2D;AAG3D,IAAA,MAAM,EAAE,mBAAmB,CAAC,KAAD,EAAQ,IAAR;AAHgC,GAAvB,CAA/B,CAAP;AAKD;;AAED,SAAS,mBAAT,CAA6B,QAA7B,EAA+C;AAC7C,SAAO,CAAC,CAAC,OAAD,EAAU;AAAE,IAAA,KAAK,EAAE;AAAT,GAAV,EAA0C,CAChD,CAAC,CACC,IADD,EAEC,QAAQ,CAAC,GAAT,CAAa,GAAG,IAAI,CAAC,CAAC,IAAD,EAAO;AAAE,IAAA,GAAG,EAAE,GAAP;AAAY,IAAA,KAAK,EAAE;AAAnB,GAAP,EAA+C,GAA/C,CAArB,CAFD,CAD+C,CAA1C,CAAR;AAMD;;AAED,SAAS,mBAAT,CAA6B,KAA7B,EAA2D,WAA3D,EAAyF;AACvF,SAAO,SAAS,gBAAT,CAA0B,QAA1B,EAA4C;AACjD,WAAO,CAAC,CAAC,mBAAD,EAAsB;AAC5B,MAAA,GAAG,EAAE,QAAQ,CAAC,UADc;AAE5B,MAAA,UAAU,EAAE,KAAK,CAAC,UAFU;AAG5B,6BAAuB,KAAK,CAAC,qBAAD,CAHA;AAI5B,MAAA,WAAW,EAAE,WAAW,CAAC,KAJG;AAK5B,8BAAyB,GAAD,IAAsB;AAC5C,QAAA,WAAW,CAAC,KAAZ,GAAoB,GAApB;AACD,OAP2B;AAQ5B,MAAA,IAAI,EAAE,QAAQ,CAAC,IARa;AAS5B,MAAA,UAAU,EAAE,QAAQ,CAAC,UATO;AAU5B,MAAA,KAAK,EAAE,KAAK,CAAC,KAVe;AAW5B,MAAA,OAAO,EAAE,YAAY,CAAC,KAAK,CAAC,OAAP,CAXO;AAY5B,MAAA,OAAO,EAAE,YAAY,CAAC,KAAK,CAAC,OAAP,CAZO;AAa5B,MAAA,iBAAiB,EAAE,KAAK,CAAC,iBAbG;AAc5B,MAAA,sBAAsB,EAAE,KAAK,CAAC,sBAdF;AAe5B,MAAA,eAAe,EAAE,YAAY,CAAC,KAAK,CAAC,eAAP,CAfD;AAgB5B,MAAA,MAAM,EAAE,QAAQ,CAAC,MAhBW;AAiB5B,MAAA,UAAU,EAAE,KAAK,CAAC;AAjBU,KAAtB,CAAR;AAmBD,GApBD;AAqBD;;AAED,SAAS,iBAAT,CAA2B,KAA3B,EAAyD,WAAzD,EAAuF;AACrF,SAAO,CAAC,CACN,OADM,EAEN;AACE,IAAA,KAAK,EAAE,CAAC,iBAAD,EAAoB;AAAE,oBAAc,CAAC,OAAO,CAAC,KAAK,CAAC,MAAP;AAAxB,KAApB;AADT,GAFM,EAKN,QAAQ,CAAC,KAAD,CAAR,CAAgB,GAAhB,CAAoB,mBAAmB,CAAC,KAAD,EAAQ,WAAR,CAAvC,CALM,CAAR;AAOD;;AAED,eAAe,eAAe,CAAC;AAC7B,EAAA,IAAI,EAAE,oBADuB;AAE7B,EAAA,KAAK,EAAE,+BAFsB;;AAG7B,EAAA,KAAK,CAAC,KAAD,EAAM;AACT,UAAM,WAAW,GAAG,QAAQ,CAAC;AAC3B,MAAA,GAAG,GAAA;AACD,eAAO,KAAK,CAAC,WAAb;AACD,OAH0B;;AAI3B,MAAA,GAAG,CAAC,IAAD,EAAmB;AACpB,YAAI,MAAM,CAAC,IAAD,CAAV,EAAkB;AAChB,UAAA,KAAK,CAAC,sBAAD,CAAL,CAA8B,IAA9B;AACD,SAFD,MAEO,IAAI,KAAK,CAAC,OAAN,IAAiB,KAAK,CAAC,OAA3B,EAAoC;AACzC,UAAA,KAAK,CAAC,sBAAD,CAAL,CACE,eAAe,CAAC,IAAI,CAAC,KAAN,EAAa,KAAK,CAAC,OAAnB,CAAf,IAA8C,gBAAgB,CAAC,IAAI,CAAC,KAAN,EAAa,KAAK,CAAC,OAAnB,CAA9D,GAA4F,IAA5F,GAAmG,IADrG;AAGD,SAJM,MAIA,IAAI,KAAK,CAAC,OAAV,EAAmB;AACxB,UAAA,KAAK,CAAC,sBAAD,CAAL,CAA8B,eAAe,CAAC,IAAI,CAAC,KAAN,EAAa,KAAK,CAAC,OAAnB,CAAf,GAA6C,IAA7C,GAAoD,IAAlF;AACD,SAFM,MAEA,IAAI,KAAK,CAAC,OAAV,EAAmB;AACxB,UAAA,KAAK,CAAC,sBAAD,CAAL,CAA8B,gBAAgB,CAAC,IAAI,CAAC,KAAN,EAAa,KAAK,CAAC,OAAnB,CAAhB,GAA8C,IAA9C,GAAqD,IAAnF;AACD,SAFM,MAEA;AACL,UAAA,KAAK,CAAC,sBAAD,CAAL,CAA8B,IAA9B;AACD;AACF;;AAlB0B,KAAD,CAA5B;AAoBA,WAAO,MAAK;AACV,aAAO,CAAC,CAAC,OAAD,EAAU;AAAE,QAAA,KAAK,EAAE;AAAT,OAAV,EAAyC,CAC/C,mBAAmB,CAAC,MAAM,CAAC,CAAC,KAAK,CAAC,cAAR,CAAN,CAA8B,KAAK,CAAC,QAApC,CAAD,CAD4B,EAE/C,iBAAiB,CAAC,KAAD,EAAQ,WAAR,CAF8B,CAAzC,CAAR;AAID,KALD;AAMD;;AA9B4B,CAAD,CAA9B","sourcesContent":["import './datepicker.sass';\nimport { DateEvent, DEFAULT_DAY_NAMES, DEFAULT_MONTH_NAMES, MonthNumber } from './shared';\nimport {\n  addDays,\n  getDatesInWeek,\n  getEndOfMonth,\n  getEndOfWeek,\n  getStartOfMonth,\n  getStartOfWeek,\n  isDate,\n  isOnOrAfterDate,\n  isOnOrBeforeDate,\n  isWithinWeek,\n  WeekdayNumber\n} from './utils';\nimport { constEmptyArray } from '../../../utils/helpers';\nimport { isEmpty, rotate } from 'fp-ts/lib/Array';\nimport { constant, FunctionN } from 'fp-ts/lib/function';\nimport { fromNullable, isNone, none, Option } from 'fp-ts/lib/Option';\nimport { defineComponent, PropType, VNode, ExtractPropTypes, h, computed, Ref } from 'vue';\nimport BDatepickerTableRow from './BDatepickerTableRow';\n\nexport const BDatepickerTablePropsDefinition = {\n  modelValue: {\n    type: [Array, Date] as PropType<Date | Date[]>\n  },\n  'onUpdate:modelValue': {\n    type: Function as PropType<FunctionN<[Date | Date[]], void>>,\n    required: true as const\n  },\n  focusedDate: {\n    type: Object as PropType<Option<Date>>,\n    required: true as const\n  },\n  'onUpdate:focusedDate': {\n    type: Function as PropType<FunctionN<[Option<Date>], any>>,\n    required: true as const\n  },\n  month: {\n    type: Number as PropType<MonthNumber>,\n    required: true as const\n  },\n  year: {\n    type: Number,\n    required: true as const\n  },\n  dayNames: {\n    type: Array as PropType<string[]>,\n    default: constant(DEFAULT_DAY_NAMES)\n  },\n  monthNames: {\n    type: Array as PropType<string[]>,\n    default: constant(DEFAULT_MONTH_NAMES)\n  },\n  firstDayOfWeek: {\n    type: Number as PropType<WeekdayNumber>,\n    default: 0 as const\n  },\n  events: {\n    type: Array as PropType<DateEvent[]>,\n    default: constEmptyArray\n  },\n  indicators: {\n    type: String as PropType<'dots' | 'bars'>,\n    required: true as const\n  },\n  minDate: {\n    type: Date as PropType<Date>,\n    required: false\n  },\n  maxDate: {\n    type: Date as PropType<Date>,\n    required: false\n  },\n  isDisabled: {\n    type: Boolean,\n    default: false\n  },\n  unselectableDates: {\n    type: Array as PropType<Date[]>,\n    default: constEmptyArray\n  },\n  unselectableDaysOfWeek: {\n    type: Array as PropType<number[]>,\n    default: constEmptyArray\n  },\n  selectableDates: {\n    type: Object as PropType<Date[]>\n  },\n  showWeekNumber: {\n    type: Boolean as PropType<boolean>,\n    default: false as const\n  }\n};\n\nexport type BDatepickerTableProps = ExtractPropTypes<typeof BDatepickerTablePropsDefinition>;\n\ninterface WeekData {\n  week: Date[];\n  weekNumber: number;\n  events: DateEvent[];\n}\n\nfunction getWeeksWithinMonth(props: BDatepickerTableProps) {\n  const startOfMonth = getStartOfMonth(new Date(props.year, props.month + 1, 0));\n  const endOfCalendar = getEndOfWeek(getEndOfMonth(startOfMonth), props.firstDayOfWeek);\n  const weeks: Date[][] = [];\n  let date = getStartOfWeek(startOfMonth, props.firstDayOfWeek);\n\n  while (isOnOrBeforeDate(date, endOfCalendar)) {\n    weeks.push(getDatesInWeek(date, props.firstDayOfWeek));\n    date = addDays(date, 7);\n  }\n  return weeks;\n}\n\nfunction getEventsWithinWeek(props: BDatepickerTableProps, week: Date[]) {\n  return props.events.filter(event => {\n    const eventDate = isDate(event) ? event : event.date;\n    return isWithinWeek(week[0], eventDate, props.firstDayOfWeek);\n  });\n}\n\nfunction getWeeks(props: BDatepickerTableProps) {\n  return getWeeksWithinMonth(props).map((week, weekNumber) => ({\n    week,\n    weekNumber,\n    events: getEventsWithinWeek(props, week)\n  }));\n}\n\nfunction generateTableHeader(dayNames: string[]) {\n  return h('thead', { class: 'datepicker-header' }, [\n    h(\n      'tr',\n      dayNames.map(day => h('th', { key: day, class: 'datepicker-cell' }, day))\n    )\n  ]);\n}\n\nfunction getGenerateTableRow(props: BDatepickerTableProps, focusedDate: Ref<Option<Date>>) {\n  return function generateTableRow(weekData: WeekData): VNode {\n    return h(BDatepickerTableRow, {\n      key: weekData.weekNumber,\n      modelValue: props.modelValue,\n      'onUpdate:modelValue': props['onUpdate:modelValue'],\n      focusedDate: focusedDate.value,\n      'onUpdate:focusedDate': (val: Option<Date>) => {\n        focusedDate.value = val;\n      },\n      week: weekData.week,\n      weekNumber: weekData.weekNumber,\n      month: props.month,\n      minDate: fromNullable(props.minDate),\n      maxDate: fromNullable(props.maxDate),\n      unselectableDates: props.unselectableDates,\n      unselectableDaysOfWeek: props.unselectableDaysOfWeek,\n      selectableDates: fromNullable(props.selectableDates),\n      events: weekData.events,\n      indicators: props.indicators\n    });\n  };\n}\n\nfunction generateTableBody(props: BDatepickerTableProps, focusedDate: Ref<Option<Date>>): VNode {\n  return h(\n    'tbody',\n    {\n      class: ['datepicker-body', { 'has-events': !isEmpty(props.events) }]\n    },\n    getWeeks(props).map(getGenerateTableRow(props, focusedDate))\n  );\n}\n\nexport default defineComponent({\n  name: 'b-datepicker-table',\n  props: BDatepickerTablePropsDefinition,\n  setup(props) {\n    const focusedDate = computed({\n      get() {\n        return props.focusedDate;\n      },\n      set(date: Option<Date>) {\n        if (isNone(date)) {\n          props['onUpdate:focusedDate'](date);\n        } else if (props.minDate && props.maxDate) {\n          props['onUpdate:focusedDate'](\n            isOnOrAfterDate(date.value, props.minDate) && isOnOrBeforeDate(date.value, props.maxDate) ? date : none\n          );\n        } else if (props.minDate) {\n          props['onUpdate:focusedDate'](isOnOrAfterDate(date.value, props.minDate) ? date : none);\n        } else if (props.maxDate) {\n          props['onUpdate:focusedDate'](isOnOrBeforeDate(date.value, props.maxDate) ? date : none);\n        } else {\n          props['onUpdate:focusedDate'](date);\n        }\n      }\n    });\n    return () => {\n      return h('table', { class: 'datepicker-table' }, [\n        generateTableHeader(rotate(-props.firstDayOfWeek)(props.dayNames)),\n        generateTableBody(props, focusedDate)\n      ]);\n    };\n  }\n});\n"],"sourceRoot":"","file":"BDatepickerTable.js"}