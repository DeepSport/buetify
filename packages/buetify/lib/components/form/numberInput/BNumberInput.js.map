{"version":3,"sources":["../../../../src/components/form/numberInput/BNumberInput.ts"],"names":[],"mappings":"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","sourcesContent":["import './number-input.sass';\nimport { IO } from 'fp-ts/lib/IO';\nimport { getUseInputPropsDefinition } from '../../../composables/input/useInput';\nimport { constant, FunctionN } from 'fp-ts/lib/function';\nimport {\n  h,\n  VNode,\n  defineComponent,\n  defineAsyncComponent,\n  PropType,\n  ExtractPropTypes,\n  computed,\n  SetupContext,\n  toRef,\n  Ref\n} from 'vue';\nimport { useProxy } from '../../../composables/proxy';\nimport { isNumber, isString } from '../../../utils/helpers';\nimport BButton from '../../button/BButton';\nimport { BInput } from '../input/BInput';\nimport { InputIcons, NumberInputIcons, DEFAULT_INPUT_ICONS } from '../shared/types';\n\nexport type BNumberInputControlsPosition = 'compact' | '';\n\nconst DEFAULT_NUMBER_INPUT_ICONS: NumberInputIcons = {\n  minus: defineAsyncComponent(() => import('../../icons/minus')),\n  plus: defineAsyncComponent(() => import('../../icons/plus'))\n};\n\nconst BNumberInputPropsDefinition = {\n  ...getUseInputPropsDefinition<number>(),\n  min: {\n    type: Number as PropType<number>,\n    default: Number.MIN_SAFE_INTEGER\n  },\n  max: {\n    type: Number as PropType<number>,\n    default: Number.MAX_SAFE_INTEGER\n  },\n  step: {\n    type: Number as PropType<number>,\n    default: 1\n  },\n  displayControls: {\n    type: Boolean as PropType<boolean>,\n    default: true\n  },\n  controlsRounded: {\n    type: Boolean as PropType<boolean>,\n    default: false\n  },\n  controlsPosition: {\n    type: String as PropType<BNumberInputControlsPosition>,\n    default: '' as const\n  },\n  inputIcons: {\n    type: Object as PropType<InputIcons>,\n    default: constant(DEFAULT_INPUT_ICONS)\n  },\n  numberInputIcons: {\n    type: Object as PropType<NumberInputIcons>,\n    default: constant(DEFAULT_NUMBER_INPUT_ICONS)\n  }\n};\n\nexport type BNumberInputProps = ExtractPropTypes<typeof BNumberInputPropsDefinition>;\n\nexport function getNumberInputIcons(icons: Partial<NumberInputIcons>): NumberInputIcons {\n  return { ...DEFAULT_NUMBER_INPUT_ICONS, ...icons };\n}\n\nfunction getFieldClasses(controlsPosition: BNumberInputControlsPosition, isExpanded: boolean) {\n  const isCompact = controlsPosition === 'compact';\n  return {\n    'is-expanded': isExpanded,\n    'has-addons': isCompact,\n    'is-grouped': !isCompact\n  };\n}\n\nfunction generateControl(props: BNumberInputProps, data: BNumberInputData, isDecrement: boolean): VNode {\n  return h(\n    'p',\n    {\n      class: 'control'\n    },\n    [\n      h(\n        BButton,\n        {\n          variant: props.variant || 'is-primary',\n          size: props.size,\n          isRounded: props.controlsRounded,\n          isDisabled: isDecrement ? !data.canDecrement.value : !data.canIncrement.value,\n          onClick: isDecrement ? data.onDecrement : data.onIncrement\n        },\n        () =>\n          h((isDecrement ? props.numberInputIcons.minus : props.numberInputIcons.plus) as any, {\n            size: props.size\n          })\n      )\n    ]\n  );\n}\n\nfunction generateInput(props: BNumberInputProps, data: BNumberInputData, context: SetupContext): VNode {\n  return h(BInput, {\n    ...context.attrs,\n    modelValue: data.number.value,\n    'onUpdate:modelValue': data.set,\n    type: 'number',\n    size: props.size,\n    placeholder: props.placeholder ? `${props.placeholder}` : '',\n    isDisabled: props.isDisabled,\n    inputIcons: props.inputIcons,\n    isReadonly: props.isReadonly,\n    isLoading: props.isLoading,\n    isRounded: props.isRounded,\n    icon: props.icon,\n    isExpanded: props.isExpanded,\n    step: props.step,\n    max: props.max,\n    min: props.min\n  });\n}\n\ninterface BNumberInputData {\n  set: FunctionN<[unknown], void>;\n  number: Ref<number | undefined>;\n  canIncrement: Ref<boolean>;\n  onDecrement: IO<void>;\n  onIncrement: IO<void>;\n  canDecrement: Ref<boolean>;\n}\n\nexport default defineComponent({\n  name: 'b-number-input',\n  props: BNumberInputPropsDefinition,\n  setup(props, context) {\n    const { value: number } = useProxy<number | undefined>(\n      toRef(props, 'modelValue'),\n      toRef(props, 'onUpdate:modelValue') as Ref<FunctionN<[number | undefined], void>>\n    );\n\n    const defaultMin = computed(() => (props.min === Number.MIN_SAFE_INTEGER ? 0 : props.min));\n\n    const defaultMax = computed(() => (props.max === Number.MAX_SAFE_INTEGER ? 0 : props.max));\n\n    const canDecrement = computed(() => (number.value ?? defaultMax.value) - props.step >= props.min);\n    function onDecrement() {\n      if (canDecrement.value) {\n        number.value = (number.value ?? 0) - props.step;\n      }\n    }\n    const canIncrement = computed(() => (props.modelValue ?? defaultMin.value) + props.step <= props.max);\n\n    function onIncrement() {\n      if (canIncrement.value) {\n        number.value = (number.value ?? 0) + props.step;\n      }\n    }\n\n    function set(val: unknown) {\n      if (isString(val)) {\n        const x = Number.parseFloat(val);\n        if (Number.isNaN(x)) return;\n        number.value = x;\n      }\n      if (isNumber(val)) {\n        number.value = val;\n      }\n    }\n\n    const data: BNumberInputData = {\n      set,\n      number,\n      canDecrement,\n      canIncrement,\n      onDecrement,\n      onIncrement\n    };\n\n    return () => {\n      const nodes = props.displayControls\n        ? [generateControl(props, data, true), generateInput(props, data, context), generateControl(props, data, false)]\n        : [generateInput(props, data, context)];\n      return h(\n        'div',\n        { class: ['b-number-input field', getFieldClasses(props.controlsPosition, props.isExpanded)] },\n        nodes\n      );\n    };\n  }\n});\n"],"sourceRoot":"","file":"BNumberInput.js"}