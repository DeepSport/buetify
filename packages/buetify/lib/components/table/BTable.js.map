{"version":3,"sources":["../../../src/components/table/BTable.ts"],"names":[],"mappings":"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","sourcesContent":["import { isEmpty } from 'fp-ts/lib/Array';\nimport { FunctionN } from 'fp-ts/lib/function';\nimport { defineComponent, h, PropType, VNode, Ref, ExtractPropTypes, computed, Slots, toRef } from 'vue';\nimport { ExtractedPaginationState } from '../../composables/pagination';\nimport { useProxy } from '../../composables/proxy';\nimport { useWindowSize } from '../../composables/windowSize';\nimport { isBoolean } from '../../utils/helpers';\nimport { Classes } from '../../utils/mergeClasses';\nimport BPagination, { PaginationPosition, PaginationSize, PaginationVerticalPosition } from '../pagination/BPagination';\nimport BSimpleTable, { BSimpleTablePropsDefinition } from './BSimpleTable';\nimport BTableHeader from './BTableHeader';\nimport BTableMobileSort from './BTableMobileSort';\nimport BTableRowElement from './BTableRow';\nimport { provideVisibleColumns } from './composables/shared';\nimport { BTableCheckPropsDefinition, useCheckableTable } from './composables/useCheckableTable';\nimport { BTableDraggablePropsDefinition, useDraggableTable } from './composables/useDraggableTable';\nimport { BTableSelectablePropsDefinition, useSelectableTable } from './composables/useSelectableTable';\nimport { BTableSortingPropsDefinition, useSortableTable } from './composables/useSortableTable';\nimport { BTableColumn, BTableRow } from './shared';\n\nexport interface BTablePaginationInput {\n  page?: number;\n  'onUpdate:page'?: FunctionN<[number], void>;\n  perPage?: number;\n  size?: PaginationSize;\n  isSimple?: boolean;\n  isRounded?: boolean;\n  horizontalPosition?: PaginationPosition;\n  verticalPosition?: PaginationVerticalPosition;\n}\n\nexport const BTablePropsDefinition = {\n  columns: {\n    type: Array as PropType<BTableColumn<unknown>[]>,\n    required: true as const\n  },\n  isFocusable: {\n    type: Boolean as PropType<boolean>,\n    default: false\n  },\n  mobileSortPlaceholder: {\n    type: String as PropType<string>\n  },\n  headerClasses: {\n    type: [String, Object, Array] as PropType<Classes>,\n    default: undefined\n  },\n  onRowClick: {\n    type: Function as PropType<FunctionN<[BTableRow, MouseEvent], void>>,\n    required: false\n  },\n  pagination: {\n    type: [Boolean, Object] as PropType<boolean | BTablePaginationInput>,\n    required: false\n  },\n  ...BSimpleTablePropsDefinition,\n  ...BTableCheckPropsDefinition,\n  ...BTableDraggablePropsDefinition,\n  ...BTableSelectablePropsDefinition,\n  ...BTableSortingPropsDefinition,\n  useMobileCards: {\n    type: Boolean as PropType<boolean>,\n    default: true\n  }\n};\n\nexport interface BTableProps extends ExtractPropTypes<typeof BTablePropsDefinition> {}\n\nfunction generateTableHeader(classes: Classes, slots: Slots): VNode {\n  return h(\n    BTableHeader,\n    {\n      class: classes\n    },\n    { ...slots }\n  );\n}\n\nfunction generateEmptyTable(visibleColumns: Ref<BTableColumn[]>, slots: Slots): VNode {\n  return h('tbody', [\n    h('tr', { class: 'is-empty' }, [h('td', { colspan: visibleColumns.value.length }, slots.empty && slots.empty())])\n  ]);\n}\n\nfunction generateTableBody(\n  props: BTableProps,\n  rows: BTableRow[],\n  visibleColumns: Ref<BTableColumn[]>,\n  slots: Slots\n): VNode {\n  if (isEmpty(props.rows)) {\n    return generateEmptyTable(visibleColumns, slots);\n  }\n  const onRowClick = props.onRowClick;\n  return h(\n    'tbody',\n    rows.map((row, index) =>\n      slots.row\n        ? slots.row({\n            row,\n            index,\n            onRowClick,\n            columns: visibleColumns.value\n          })\n        : h(\n            BTableRowElement,\n            {\n              key: row.id as string | number,\n              row,\n              index,\n              onRowClick\n            },\n            { ...slots }\n          )\n    )\n  );\n}\n\nfunction generateTableFooter(visibleColumns: Ref<BTableColumn[]>, slots: Slots): VNode {\n  return h('tfoot', [\n    h(\n      'tr',\n      { class: 'table-footer' },\n      slots.footer && slots.footer({ numberOfColumns: visibleColumns.value.length, columns: visibleColumns.value })\n    )\n  ]);\n}\n\nfunction generateTable(\n  props: BTableProps,\n  rows: BTableRow[],\n  visibleColumns: Ref<BTableColumn[]>,\n  slots: Slots\n): VNode {\n  return h(BSimpleTable, props, () => {\n    const nodes = [\n      generateTableHeader(props.headerClasses, slots),\n      generateTableBody(props, rows, visibleColumns, slots)\n    ];\n    if (slots.footer) {\n      nodes.push(generateTableFooter(visibleColumns, slots));\n    }\n    return nodes;\n  });\n}\n\nexport default defineComponent({\n  name: 'b-table',\n  props: BTablePropsDefinition,\n  setup(props, { slots }) {\n    const { value: rows } = useProxy(toRef(props, 'rows'));\n\n    const visibleColumns = computed(() => props.columns.filter(column => column.isVisible ?? true));\n\n    provideVisibleColumns(visibleColumns);\n    const { hasSortableColumns } = useSortableTable(props, rows, visibleColumns);\n    useCheckableTable(props, rows);\n    useSelectableTable(props);\n    useDraggableTable(props);\n\n    const windowSize = useWindowSize();\n    const useMobileSorting = computed(\n      () => props.useMobileCards && hasSortableColumns.value && windowSize.value.isTouch\n    );\n\n    return () => {\n      const nodes = [];\n      if (useMobileSorting.value) {\n        nodes.push(\n          h(BTableMobileSort, {\n            placeholder: props.mobileSortPlaceholder\n          })\n        );\n      }\n      if (props.pagination) {\n        nodes.push(\n          h(\n            BPagination,\n            isBoolean(props.pagination)\n              ? {\n                  total: props.rows.length,\n                  items: rows.value\n                }\n              : ({\n                  isSimple: props.pagination.isSimple,\n                  isRounded: props.pagination.isRounded,\n                  modelValue: props.pagination.page,\n                  'onUpdate:modelValue': props.pagination['onUpdate:page'],\n                  total: props.rows.length,\n                  items: rows.value,\n                  perPage: props.pagination.perPage,\n                  size: props.pagination.size,\n                  position: props.pagination.horizontalPosition,\n                  verticalPosition: props.pagination.verticalPosition\n                } as any), // eslint-disable-line\n            {\n              default: (paginatedState: ExtractedPaginationState) => {\n                return generateTable(props, paginatedState.paginatedItems as BTableRow[], visibleColumns, slots);\n              }\n            }\n          )\n        );\n        return h('div', nodes);\n      } else {\n        nodes.push(generateTable(props, rows.value, visibleColumns, slots));\n        return h('div', nodes);\n      }\n    };\n  }\n});\n"],"sourceRoot":"","file":"BTable.js"}