import { isObject, isString } from '../../utils/helpers';
import { computed, toRefs, watch, shallowReactive, shallowRef, toRef } from 'vue';
import { useFieldData } from '../fieldData';
import { useFocus, UseFocusPropsDefinition } from '../focus';
import { getUseModelPropsDefinition, useModel } from '../model';
import { useToggle } from '../toggle';
import { useValidation, UseValidationPropsDefinition } from '../validation';
export const StaticUseInputProps = {
    variant: {
        type: String,
        default: 'is-primary'
    },
    type: {
        type: String
    },
    autocomplete: {
        type: String
    },
    placeholder: {
        type: String
    },
    size: {
        type: String,
        default: ''
    },
    isRequired: {
        type: Boolean,
        default: true
    },
    isExpanded: {
        type: Boolean,
        default: false
    },
    isLoading: {
        type: Boolean,
        default: false
    },
    isRounded: {
        type: Boolean,
        default: false
    },
    maxlength: {
        type: [Number, String]
    },
    icon: null,
    usePasswordReveal: {
        type: Boolean,
        default: false
    },
    ...UseValidationPropsDefinition,
    ...UseFocusPropsDefinition
};
export function getUseInputPropsDefinition() {
    return {
        ...getUseModelPropsDefinition(),
        ...StaticUseInputProps
    };
}
function getIconSize(size) {
    switch (size) {
        case 'is-small':
            return size;
        default:
            return '';
    }
}
function getMessageVariant(variant) {
    if (isString(variant)) {
        return variant;
    }
    else if (isObject(variant)) {
        return Object.values(variant)[0];
    }
    else {
        return undefined;
    }
}
export function useInput(props, ref) {
    const fieldData = useFieldData();
    const isExpanded = computed(() => props.isExpanded || fieldData.attrs.isExpanded.value);
    const model = useModel(props);
    const focus = useFocus(props, ref);
    const validate = useValidation(props, ref);
    watch(model.modelValue, validate.validate);
    const iconSize = computed(() => getIconSize(props.size));
    const messageVariant = computed(() => getMessageVariant(fieldData.attrs.messageVariant.value));
    const passwordToggle = useToggle(shallowReactive({ isVisible: false, hasPopup: false }), 'isVisible');
    const type = shallowRef(props.type);
    watch(toRef(props, 'type'), newVal => {
        type.value = newVal;
    });
    watch(passwordToggle.isOn, newVal => {
        type.value = newVal ? 'text' : 'password';
    });
    return {
        ...toRefs(props),
        ...fieldData.attrs,
        ...fieldData.setters,
        isExpanded,
        isFullwidth: isExpanded,
        messageVariant,
        setters: fieldData.setters,
        ...model,
        ...focus,
        ...validate,
        iconSize,
        type,
        passwordToggle
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlSW5wdXQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9zYWJsZXMvaW5wdXQvdXNlSW5wdXQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQUN6RCxPQUFPLEVBQW1DLFFBQVEsRUFBRSxNQUFNLEVBQUUsS0FBSyxFQUFFLGVBQWUsRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFFLE1BQU0sS0FBSyxDQUFDO0FBQ25ILE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDNUMsT0FBTyxFQUFFLFFBQVEsRUFBRSx1QkFBdUIsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUM3RCxPQUFPLEVBQUUsMEJBQTBCLEVBQUUsUUFBUSxFQUFpQixNQUFNLFVBQVUsQ0FBQztBQUMvRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBQ3RDLE9BQU8sRUFBRSxhQUFhLEVBQUUsNEJBQTRCLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFFNUUsTUFBTSxDQUFDLE1BQU0sbUJBQW1CLEdBQUc7SUFDakMsT0FBTyxFQUFFO1FBQ1AsSUFBSSxFQUFFLE1BQWdDO1FBQ3RDLE9BQU8sRUFBRSxZQUFxQjtLQUMvQjtJQUNELElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxNQUEwQjtLQUNqQztJQUNELFlBQVksRUFBRTtRQUNaLElBQUksRUFBRSxNQUEwQjtLQUNqQztJQUNELFdBQVcsRUFBRTtRQUNYLElBQUksRUFBRSxNQUEwQjtLQUNqQztJQUNELElBQUksRUFBRTtRQUNKLElBQUksRUFBRSxNQUErQjtRQUNyQyxPQUFPLEVBQUUsRUFBaUI7S0FDM0I7SUFDRCxVQUFVLEVBQUU7UUFDVixJQUFJLEVBQUUsT0FBTztRQUNiLE9BQU8sRUFBRSxJQUFJO0tBQ2Q7SUFDRCxVQUFVLEVBQUU7UUFDVixJQUFJLEVBQUUsT0FBNEI7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LFVBQVUsQ0FBQztJQUM1QyxDQUFDLENBQUMsQ0FBQztJQUNILE9BQU87UUFDTCxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUM7UUFDaEIsR0FBRyxTQUFTLENBQUMsS0FBSztRQUNsQixHQUFHLFNBQVMsQ0FBQyxPQUFPO1FBQ3BCLFVBQVU7UUFDVixXQUFXLEVBQUUsVUFBVTtRQUN2QixjQUFjO1FBQ2QsT0FBTyxFQUFFLFNBQVMsQ0FBQyxPQUFPO1FBQzFCLEdBQUcsS0FBSztRQUNSLEdBQUcsS0FBSztRQUNSLEdBQUcsUUFBUTtRQUNYLFFBQVE7UUFDUixJQUFJO1FBQ0osY0FBYztLQUNmLENBQUM7QUFDSixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQWxsQ29sb3JzVmFyaWFudCwgQ29sb3JWYXJpYW50IH0gZnJvbSAnLi4vLi4vdHlwZXMvQ29sb3JWYXJpYW50cyc7XG5pbXBvcnQgeyBTaXplVmFyaWFudCB9IGZyb20gJy4uLy4uL3R5cGVzL1NpemVWYXJpYW50cyc7XG5pbXBvcnQgeyBpc09iamVjdCwgaXNTdHJpbmcgfSBmcm9tICcuLi8uLi91dGlscy9oZWxwZXJzJztcbmltcG9ydCB7IFByb3BUeXBlLCBFeHRyYWN0UHJvcFR5cGVzLCBSZWYsIGNvbXB1dGVkLCB0b1JlZnMsIHdhdGNoLCBzaGFsbG93UmVhY3RpdmUsIHNoYWxsb3dSZWYsIHRvUmVmIH0gZnJvbSAndnVlJztcbmltcG9ydCB7IHVzZUZpZWxkRGF0YSB9IGZyb20gJy4uL2ZpZWxkRGF0YSc7XG5pbXBvcnQgeyB1c2VGb2N1cywgVXNlRm9jdXNQcm9wc0RlZmluaXRpb24gfSBmcm9tICcuLi9mb2N1cyc7XG5pbXBvcnQgeyBnZXRVc2VNb2RlbFByb3BzRGVmaW5pdGlvbiwgdXNlTW9kZWwsIFVzZU1vZGVsUHJvcHMgfSBmcm9tICcuLi9tb2RlbCc7XG5pbXBvcnQgeyB1c2VUb2dnbGUgfSBmcm9tICcuLi90b2dnbGUnO1xuaW1wb3J0IHsgdXNlVmFsaWRhdGlvbiwgVXNlVmFsaWRhdGlvblByb3BzRGVmaW5pdGlvbiB9IGZyb20gJy4uL3ZhbGlkYXRpb24nO1xuXG5leHBvcnQgY29uc3QgU3RhdGljVXNlSW5wdXRQcm9wcyA9IHtcbiAgdmFyaWFudDoge1xuICAgIHR5cGU6IFN0cmluZyBhcyBQcm9wVHlwZTxDb2xvclZhcmlhbnQ+LFxuICAgIGRlZmF1bHQ6ICdpcy1wcmltYXJ5JyBhcyBjb25zdFxuICB9LFxuICB0eXBlOiB7XG4gICAgdHlwZTogU3RyaW5nIGFzIFByb3BUeXBlPHN0cmluZz5cbiAgfSxcbiAgYXV0b2NvbXBsZXRlOiB7XG4gICAgdHlwZTogU3RyaW5nIGFzIFByb3BUeXBlPHN0cmluZz5cbiAgfSxcbiAgcGxhY2Vob2xkZXI6IHtcbiAgICB0eXBlOiBTdHJpbmcgYXMgUHJvcFR5cGU8c3RyaW5nPlxuICB9LFxuICBzaXplOiB7XG4gICAgdHlwZTogU3RyaW5nIGFzIFByb3BUeXBlPFNpemVWYXJpYW50PixcbiAgICBkZWZhdWx0OiAnJyBhcyBTaXplVmFyaWFudFxuICB9LFxuICBpc1JlcXVpcmVkOiB7XG4gICAgdHlwZTogQm9vbGVhbixcbiAgICBkZWZhdWx0OiB0cnVlXG4gIH0sXG4gIGlzRXhwYW5kZWQ6IHtcbiAgICB0eXBlOiBCb29sZWFuIGFzIFByb3BUeXBlPGJvb2xlYW4+LFxuICAgIGRlZmF1bHQ6IGZhbHNlXG4gIH0sXG4gIGlzTG9hZGluZzoge1xuICAgIHR5cGU6IEJvb2xlYW4gYXMgUHJvcFR5cGU8Ym9vbGVhbj4sXG4gICAgZGVmYXVsdDogZmFsc2VcbiAgfSxcbiAgaXNSb3VuZGVkOiB7XG4gICAgdHlwZTogQm9vbGVhbiBhcyBQcm9wVHlwZTxib29sZWFuPixcbiAgICBkZWZhdWx0OiBmYWxzZVxuICB9LFxuICBtYXhsZW5ndGg6IHtcbiAgICB0eXBlOiBbTnVtYmVyLCBTdHJpbmddIGFzIFByb3BUeXBlPG51bWJlciB8IHN0cmluZz5cbiAgfSxcbiAgaWNvbjogbnVsbCxcbiAgdXNlUGFzc3dvcmRSZXZlYWw6IHtcbiAgICB0eXBlOiBCb29sZWFuIGFzIFByb3BUeXBlPGJvb2xlYW4+LFxuICAgIGRlZmF1bHQ6IGZhbHNlXG4gIH0sXG4gIC4uLlVzZVZhbGlkYXRpb25Qcm9wc0RlZmluaXRpb24sXG4gIC4uLlVzZUZvY3VzUHJvcHNEZWZpbml0aW9uXG59O1xuXG50eXBlIFN0YXRpY0lucHV0UHJvcHMgPSBFeHRyYWN0UHJvcFR5cGVzPHR5cGVvZiBTdGF0aWNVc2VJbnB1dFByb3BzPjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFVzZUlucHV0UHJvcHNEZWZpbml0aW9uPFQ+KCkge1xuICByZXR1cm4ge1xuICAgIC4uLmdldFVzZU1vZGVsUHJvcHNEZWZpbml0aW9uPFQ+KCksXG4gICAgLi4uU3RhdGljVXNlSW5wdXRQcm9wc1xuICB9O1xufVxuXG5leHBvcnQgdHlwZSBVc2VJbnB1dFByb3BzPFQ+ID0gVXNlTW9kZWxQcm9wczxUPiAmIFN0YXRpY0lucHV0UHJvcHM7XG5cbmZ1bmN0aW9uIGdldEljb25TaXplKHNpemU/OiBTaXplVmFyaWFudCkge1xuICBzd2l0Y2ggKHNpemUpIHtcbiAgICBjYXNlICdpcy1zbWFsbCc6XG4gICAgICByZXR1cm4gc2l6ZTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuICcnO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldE1lc3NhZ2VWYXJpYW50KHZhcmlhbnQ6IHVuZGVmaW5lZCB8IEFsbENvbG9yc1ZhcmlhbnQgfCBQYXJ0aWFsPHsgW0sgaW4gQWxsQ29sb3JzVmFyaWFudF06IGJvb2xlYW4gfT4pIHtcbiAgaWYgKGlzU3RyaW5nKHZhcmlhbnQpKSB7XG4gICAgcmV0dXJuIHZhcmlhbnQ7XG4gIH0gZWxzZSBpZiAoaXNPYmplY3QodmFyaWFudCkpIHtcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyh2YXJpYW50KVswXSBhcyBhbnk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdXNlSW5wdXQ8VD4ocHJvcHM6IFVzZUlucHV0UHJvcHM8VD4sIHJlZjogUmVmPEhUTUxFbGVtZW50Pikge1xuICBjb25zdCBmaWVsZERhdGEgPSB1c2VGaWVsZERhdGEoKTtcbiAgY29uc3QgaXNFeHBhbmRlZCA9IGNvbXB1dGVkKCgpID0+IHByb3BzLmlzRXhwYW5kZWQgfHwgZmllbGREYXRhLmF0dHJzLmlzRXhwYW5kZWQudmFsdWUpO1xuICBjb25zdCBtb2RlbCA9IHVzZU1vZGVsKHByb3BzKTtcbiAgY29uc3QgZm9jdXMgPSB1c2VGb2N1cyhwcm9wcywgcmVmKTtcbiAgY29uc3QgdmFsaWRhdGUgPSB1c2VWYWxpZGF0aW9uKHByb3BzLCByZWYpO1xuICB3YXRjaChtb2RlbC5tb2RlbFZhbHVlLCB2YWxpZGF0ZS52YWxpZGF0ZSk7XG4gIGNvbnN0IGljb25TaXplID0gY29tcHV0ZWQoKCkgPT4gZ2V0SWNvblNpemUocHJvcHMuc2l6ZSkpO1xuICBjb25zdCBtZXNzYWdlVmFyaWFudCA9IGNvbXB1dGVkKCgpID0+IGdldE1lc3NhZ2VWYXJpYW50KGZpZWxkRGF0YS5hdHRycy5tZXNzYWdlVmFyaWFudC52YWx1ZSkpO1xuICBjb25zdCBwYXNzd29yZFRvZ2dsZSA9IHVzZVRvZ2dsZShzaGFsbG93UmVhY3RpdmUoeyBpc1Zpc2libGU6IGZhbHNlLCBoYXNQb3B1cDogZmFsc2UgfSksICdpc1Zpc2libGUnKTtcbiAgY29uc3QgdHlwZSA9IHNoYWxsb3dSZWYocHJvcHMudHlwZSk7XG4gIHdhdGNoKHRvUmVmKHByb3BzLCAndHlwZScpLCBuZXdWYWwgPT4ge1xuICAgIHR5cGUudmFsdWUgPSBuZXdWYWw7XG4gIH0pO1xuICB3YXRjaChwYXNzd29yZFRvZ2dsZS5pc09uLCBuZXdWYWwgPT4ge1xuICAgIHR5cGUudmFsdWUgPSBuZXdWYWwgPyAndGV4dCcgOiAncGFzc3dvcmQnO1xuICB9KTtcbiAgcmV0dXJuIHtcbiAgICAuLi50b1JlZnMocHJvcHMpLFxuICAgIC4uLmZpZWxkRGF0YS5hdHRycyxcbiAgICAuLi5maWVsZERhdGEuc2V0dGVycyxcbiAgICBpc0V4cGFuZGVkLFxuICAgIGlzRnVsbHdpZHRoOiBpc0V4cGFuZGVkLFxuICAgIG1lc3NhZ2VWYXJpYW50LFxuICAgIHNldHRlcnM6IGZpZWxkRGF0YS5zZXR0ZXJzLFxuICAgIC4uLm1vZGVsLFxuICAgIC4uLmZvY3VzLFxuICAgIC4uLnZhbGlkYXRlLFxuICAgIGljb25TaXplLFxuICAgIHR5cGUsXG4gICAgcGFzc3dvcmRUb2dnbGVcbiAgfTtcbn1cblxuZXhwb3J0IHR5cGUgSW5wdXQgPSBSZXR1cm5UeXBlPHR5cGVvZiB1c2VJbnB1dD47XG4iXX0=