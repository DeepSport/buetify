import { toRef, computed, provide, inject } from 'vue';
import { constant, constFalse, constTrue, constVoid } from 'fp-ts/lib/function';
import { useProxy } from '../../../composables/proxy/useProxy';
import { constEmptyArray } from '../../../utils/helpers';
import { toggleBTableRow } from '../shared';
import { toSet } from './shared';
export const BTableCheckPropsDefinition = {
    isCheckable: {
        type: Boolean,
        default: false
    },
    checkedRows: {
        type: Array,
        default: constEmptyArray()
    },
    'onUpdate:checkedRows': {
        type: Function,
        default: constant(constVoid)
    },
    checkboxVariant: {
        type: String,
        default: 'is-primary'
    },
    canCheckAllRows: {
        type: Boolean,
        default: true
    },
    onCheckRow: {
        type: Function,
        default: constant(constVoid)
    },
    onUncheckRow: {
        type: Function,
        default: constant(constVoid)
    }
};
const USE_CHECKABLE_TABLE_INJECTION_SYMBOL = Symbol();
export function useCheckableTable(props, rows) {
    const checkableRows = computed(() => (props.isCheckable ? rows.value.filter(row => row.isCheckable) : []));
    const { value: checkedRows } = useProxy(computed(() => (props.isCheckable ? props.checkedRows : [])), toRef(props, 'onUpdate:checkedRows'));
    const checkedRowIds = computed(() => toSet(checkedRows.value));
    const allRowsChecked = computed(() => {
        const ids = checkedRowIds.value;
        return checkableRows.value.length > 0 && checkableRows.value.every(row => ids.has(row.id));
    });
    const allRowsUncheckable = computed(() => rows.value.every(row => !row.isCheckable));
    function checkAllRows() {
        checkedRows.value = checkableRows.value;
    }
    function toggleRow(row) {
        if (row.isCheckable) {
            const ids = checkedRowIds.value;
            ids.has(row.id) ? props.onUncheckRow(row) : props.onCheckRow(row);
            checkedRows.value = toggleBTableRow(row, checkedRows.value);
        }
    }
    function uncheckAllRows() {
        checkedRows.value = [];
    }
    function toggleAllRows() {
        allRowsChecked.value ? uncheckAllRows() : checkAllRows();
    }
    const hasCheckableRows = computed(() => checkableRows.value.length > 0);
    const state = {
        isCheckable: computed(() => props.isCheckable),
        variant: computed(() => props.checkboxVariant),
        checkedRowIds,
        toggleAllRows,
        checkAllRows,
        uncheckAllRows,
        allRowsChecked,
        toggleRow,
        allRowsUncheckable,
        hasCheckableRows,
        allRowsUnchecked: computed(() => hasCheckableRows.value && checkedRowIds.value.size === 0)
    };
    provide(USE_CHECKABLE_TABLE_INJECTION_SYMBOL, state);
    return state;
}
function useDefaultCheckableTableState() {
    return {
        isCheckable: computed(constFalse),
        variant: computed(() => 'is-primary'),
        checkedRowIds: computed(() => new Set()),
        toggleAllRows: constVoid,
        checkAllRows: constVoid,
        uncheckAllRows: constVoid,
        toggleRow: constVoid,
        allRowsChecked: computed(constFalse),
        allRowsUncheckable: computed(constFalse),
        hasCheckableRows: computed(constFalse),
        allRowsUnchecked: computed(constTrue)
    };
}
export function useInjectedCheckableTable() {
    return inject(USE_CHECKABLE_TABLE_INJECTION_SYMBOL, useDefaultCheckableTableState, true);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXNlQ2hlY2thYmxlVGFibGUuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy90YWJsZS9jb21wb3NhYmxlcy91c2VDaGVja2FibGVUYWJsZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLEVBQW9CLEtBQUssRUFBRSxRQUFRLEVBQW9CLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxLQUFLLENBQUM7QUFDM0YsT0FBTyxFQUFFLFFBQVEsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBYSxNQUFNLG9CQUFvQixDQUFDO0FBRTNGLE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxxQ0FBcUMsQ0FBQztBQUUvRCxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFDekQsT0FBTyxFQUE0QixlQUFlLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDdEUsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUVqQyxNQUFNLENBQUMsTUFBTSwwQkFBMEIsR0FBRztJQUN4QyxXQUFXLEVBQUU7UUFDWCxJQUFJLEVBQUUsT0FBNEI7UUFDbEMsT0FBTyxFQUFFLEtBQUs7S0FDZjtJQUNELFdBQVcsRUFBRTtRQUNYLElBQUksRUFBRSxLQUFrQztRQUN4QyxPQUFPLEVBQUUsZUFBZSxFQUFFO0tBQzNCO0lBQ0Qsc0JBQXNCLEVBQUU7UUFDdEIsSUFBSSxFQUFFLFFBQXdEO1FBQzlELE9BQU8sRUFBRSxRQUFRLENBQUMsU0FBUyxDQUFDO0tBQzdCO0lBQ0QsZUFBZSxFQUFFO1FBQ2YsSUFBSSxFQUFFLE1BQWdDO1FBQ3RDLE9BQU8sRUFBRSxZQUFxQjtLQUMvQjtJQUNELGVBQWUsRUFBRTtRQUNmLElBQUksRUFBRSxPQUE0QjtRQUNsQyxPQUFPLEVBQUUsSUFBSTtLQUNkO0lBQ0QsVUFBVSxFQUFFO1FBQ1YsSUFBSSxFQUFFLFFBQXNEO1FBQzVELE9BQU8sRUFBRSxR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bGliL0lPJztcbmltcG9ydCB7IEV4dHJhY3RQcm9wVHlwZXMsIHRvUmVmLCBjb21wdXRlZCwgUmVmLCBDb21wdXRlZFJlZiwgcHJvdmlkZSwgaW5qZWN0IH0gZnJvbSAndnVlJztcbmltcG9ydCB7IGNvbnN0YW50LCBjb25zdEZhbHNlLCBjb25zdFRydWUsIGNvbnN0Vm9pZCwgRnVuY3Rpb25OIH0gZnJvbSAnZnAtdHMvbGliL2Z1bmN0aW9uJztcbmltcG9ydCB7IFByb3BUeXBlIH0gZnJvbSAndnVlJztcbmltcG9ydCB7IHVzZVByb3h5IH0gZnJvbSAnLi4vLi4vLi4vY29tcG9zYWJsZXMvcHJveHkvdXNlUHJveHknO1xuaW1wb3J0IHsgQ29sb3JWYXJpYW50IH0gZnJvbSAnLi4vLi4vLi4vdHlwZXMvQ29sb3JWYXJpYW50cyc7XG5pbXBvcnQgeyBjb25zdEVtcHR5QXJyYXkgfSBmcm9tICcuLi8uLi8uLi91dGlscy9oZWxwZXJzJztcbmltcG9ydCB7IEJUYWJsZVJvdywgQlRhYmxlUm93RGF0YSwgdG9nZ2xlQlRhYmxlUm93IH0gZnJvbSAnLi4vc2hhcmVkJztcbmltcG9ydCB7IHRvU2V0IH0gZnJvbSAnLi9zaGFyZWQnO1xuXG5leHBvcnQgY29uc3QgQlRhYmxlQ2hlY2tQcm9wc0RlZmluaXRpb24gPSB7XG4gIGlzQ2hlY2thYmxlOiB7XG4gICAgdHlwZTogQm9vbGVhbiBhcyBQcm9wVHlwZTxib29sZWFuPixcbiAgICBkZWZhdWx0OiBmYWxzZVxuICB9LFxuICBjaGVja2VkUm93czoge1xuICAgIHR5cGU6IEFycmF5IGFzIFByb3BUeXBlPEJUYWJsZVJvd0RhdGFbXT4sXG4gICAgZGVmYXVsdDogY29uc3RFbXB0eUFycmF5KClcbiAgfSxcbiAgJ29uVXBkYXRlOmNoZWNrZWRSb3dzJzoge1xuICAgIHR5cGU6IEZ1bmN0aW9uIGFzIFByb3BUeXBlPEZ1bmN0aW9uTjxbQlRhYmxlUm93RGF0YVtdXSwgdm9pZD4+LFxuICAgIGRlZmF1bHQ6IGNvbnN0YW50KGNvbnN0Vm9pZClcbiAgfSxcbiAgY2hlY2tib3hWYXJpYW50OiB7XG4gICAgdHlwZTogU3RyaW5nIGFzIFByb3BUeXBlPENvbG9yVmFyaWFudD4sXG4gICAgZGVmYXVsdDogJ2lzLXByaW1hcnknIGFzIGNvbnN0XG4gIH0sXG4gIGNhbkNoZWNrQWxsUm93czoge1xuICAgIHR5cGU6IEJvb2xlYW4gYXMgUHJvcFR5cGU8Ym9vbGVhbj4sXG4gICAgZGVmYXVsdDogdHJ1ZVxuICB9LFxuICBvbkNoZWNrUm93OiB7XG4gICAgdHlwZTogRnVuY3Rpb24gYXMgUHJvcFR5cGU8RnVuY3Rpb25OPFtCVGFibGVSb3dEYXRhXSwgdm9pZD4+LFxuICAgIGRlZmF1bHQ6IGNvbnN0YW50KGNvbnN0Vm9pZClcbiAgfSxcbiAgb25VbmNoZWNrUm93OiB7XG4gICAgdHlwZTogRnVuY3Rpb24gYXMgUHJvcFR5cGU8RnVuY3Rpb25OPFtCVGFibGVSb3dEYXRhXSwgdm9pZD4+LFxuICAgIGRlZmF1bHQ6IGNvbnN0YW50KGNvbnN0Vm9pZClcbiAgfVxufTtcblxuZXhwb3J0IGludGVyZmFjZSBCVGFibGVDaGVja1Byb3BzIGV4dGVuZHMgRXh0cmFjdFByb3BUeXBlczx0eXBlb2YgQlRhYmxlQ2hlY2tQcm9wc0RlZmluaXRpb24+IHt9XG5cbmNvbnN0IFVTRV9DSEVDS0FCTEVfVEFCTEVfSU5KRUNUSU9OX1NZTUJPTCA9IFN5bWJvbCgpO1xuXG5leHBvcnQgZnVuY3Rpb24gdXNlQ2hlY2thYmxlVGFibGUocHJvcHM6IEJUYWJsZUNoZWNrUHJvcHMsIHJvd3M6IFJlZjxCVGFibGVSb3dbXT4pOiBVc2VDaGVja2FibGVUYWJsZSB7XG4gIGNvbnN0IGNoZWNrYWJsZVJvd3MgPSBjb21wdXRlZCgoKSA9PiAocHJvcHMuaXNDaGVja2FibGUgPyByb3dzLnZhbHVlLmZpbHRlcihyb3cgPT4gcm93LmlzQ2hlY2thYmxlKSA6IFtdKSk7XG4gIGNvbnN0IHsgdmFsdWU6IGNoZWNrZWRSb3dzIH0gPSB1c2VQcm94eTxCVGFibGVSb3dEYXRhW10+KFxuICAgIGNvbXB1dGVkKCgpID0+IChwcm9wcy5pc0NoZWNrYWJsZSA/IHByb3BzLmNoZWNrZWRSb3dzIDogW10pKSxcbiAgICB0b1JlZihwcm9wcywgJ29uVXBkYXRlOmNoZWNrZWRSb3dzJylcbiAgKTtcblxuICBjb25zdCBjaGVja2VkUm93SWRzID0gY29tcHV0ZWQoKCkgPT4gdG9TZXQoY2hlY2tlZFJvd3MudmFsdWUpKTtcblxuICBjb25zdCBhbGxSb3dzQ2hlY2tlZCA9IGNvbXB1dGVkKCgpID0+IHtcbiAgICBjb25zdCBpZHMgPSBjaGVja2VkUm93SWRzLnZhbHVlO1xuICAgIHJldHVybiBjaGVja2FibGVSb3dzLnZhbHVlLmxlbmd0aCA+IDAgJiYgY2hlY2thYmxlUm93cy52YWx1ZS5ldmVyeShyb3cgPT4gaWRzLmhhcyhyb3cuaWQpKTtcbiAgfSk7XG5cbiAgY29uc3QgYWxsUm93c1VuY2hlY2thYmxlID0gY29tcHV0ZWQoKCkgPT4gcm93cy52YWx1ZS5ldmVyeShyb3cgPT4gIXJvdy5pc0NoZWNrYWJsZSkpO1xuXG4gIGZ1bmN0aW9uIGNoZWNrQWxsUm93cygpIHtcbiAgICBjaGVja2VkUm93cy52YWx1ZSA9IGNoZWNrYWJsZVJvd3MudmFsdWU7XG4gIH1cblxuICBmdW5jdGlvbiB0b2dnbGVSb3cocm93OiBCVGFibGVSb3cpIHtcbiAgICBpZiAocm93LmlzQ2hlY2thYmxlKSB7XG4gICAgICBjb25zdCBpZHMgPSBjaGVja2VkUm93SWRzLnZhbHVlO1xuICAgICAgaWRzLmhhcyhyb3cuaWQpID8gcHJvcHMub25VbmNoZWNrUm93KHJvdykgOiBwcm9wcy5vbkNoZWNrUm93KHJvdyk7XG4gICAgICBjaGVja2VkUm93cy52YWx1ZSA9IHRvZ2dsZUJUYWJsZVJvdyhyb3csIGNoZWNrZWRSb3dzLnZhbHVlIGFzIEJUYWJsZVJvd1tdKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiB1bmNoZWNrQWxsUm93cygpIHtcbiAgICBjaGVja2VkUm93cy52YWx1ZSA9IFtdO1xuICB9XG5cbiAgZnVuY3Rpb24gdG9nZ2xlQWxsUm93cygpIHtcbiAgICBhbGxSb3dzQ2hlY2tlZC52YWx1ZSA/IHVuY2hlY2tBbGxSb3dzKCkgOiBjaGVja0FsbFJvd3MoKTtcbiAgfVxuXG4gIGNvbnN0IGhhc0NoZWNrYWJsZVJvd3MgPSBjb21wdXRlZCgoKSA9PiBjaGVja2FibGVSb3dzLnZhbHVlLmxlbmd0aCA+IDApO1xuXG4gIGNvbnN0IHN0YXRlID0ge1xuICAgIGlzQ2hlY2thYmxlOiBjb21wdXRlZCgoKSA9PiBwcm9wcy5pc0NoZWNrYWJsZSksXG4gICAgdmFyaWFudDogY29tcHV0ZWQoKCkgPT4gcHJvcHMuY2hlY2tib3hWYXJpYW50KSxcbiAgICBjaGVja2VkUm93SWRzLFxuICAgIHRvZ2dsZUFsbFJvd3MsXG4gICAgY2hlY2tBbGxSb3dzLFxuICAgIHVuY2hlY2tBbGxSb3dzLFxuICAgIGFsbFJvd3NDaGVja2VkLFxuICAgIHRvZ2dsZVJvdyxcbiAgICBhbGxSb3dzVW5jaGVja2FibGUsXG4gICAgaGFzQ2hlY2thYmxlUm93cyxcbiAgICBhbGxSb3dzVW5jaGVja2VkOiBjb21wdXRlZCgoKSA9PiBoYXNDaGVja2FibGVSb3dzLnZhbHVlICYmIGNoZWNrZWRSb3dJZHMudmFsdWUuc2l6ZSA9PT0gMClcbiAgfTtcblxuICBwcm92aWRlKFVTRV9DSEVDS0FCTEVfVEFCTEVfSU5KRUNUSU9OX1NZTUJPTCwgc3RhdGUpO1xuXG4gIHJldHVybiBzdGF0ZTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBVc2VDaGVja2FibGVUYWJsZSB7XG4gIGlzQ2hlY2thYmxlOiBDb21wdXRlZFJlZjxib29sZWFuPjtcbiAgdmFyaWFudDogQ29tcHV0ZWRSZWY8Q29sb3JWYXJpYW50PjtcbiAgY2hlY2tlZFJvd0lkczogQ29tcHV0ZWRSZWY8U2V0PHN0cmluZz4+O1xuICB0b2dnbGVBbGxSb3dzOiBJTzx2b2lkPjtcbiAgY2hlY2tBbGxSb3dzOiBJTzx2b2lkPjtcbiAgdW5jaGVja0FsbFJvd3M6IElPPHZvaWQ+O1xuICBhbGxSb3dzQ2hlY2tlZDogQ29tcHV0ZWRSZWY8Ym9vbGVhbj47XG4gIHRvZ2dsZVJvdzogRnVuY3Rpb25OPFtCVGFibGVSb3ddLCB2b2lkPjtcbiAgYWxsUm93c1VuY2hlY2thYmxlOiBDb21wdXRlZFJlZjxib29sZWFuPjtcbiAgaGFzQ2hlY2thYmxlUm93czogQ29tcHV0ZWRSZWY8Ym9vbGVhbj47XG4gIGFsbFJvd3NVbmNoZWNrZWQ6IENvbXB1dGVkUmVmPGJvb2xlYW4+O1xufVxuXG5mdW5jdGlvbiB1c2VEZWZhdWx0Q2hlY2thYmxlVGFibGVTdGF0ZSgpOiBVc2VDaGVja2FibGVUYWJsZSB7XG4gIHJldHVybiB7XG4gICAgaXNDaGVja2FibGU6IGNvbXB1dGVkKGNvbnN0RmFsc2UpLFxuICAgIHZhcmlhbnQ6IGNvbXB1dGVkKCgpID0+ICdpcy1wcmltYXJ5JyksXG4gICAgY2hlY2tlZFJvd0lkczogY29tcHV0ZWQoKCkgPT4gbmV3IFNldCgpKSxcbiAgICB0b2dnbGVBbGxSb3dzOiBjb25zdFZvaWQsXG4gICAgY2hlY2tBbGxSb3dzOiBjb25zdFZvaWQsXG4gICAgdW5jaGVja0FsbFJvd3M6IGNvbnN0Vm9pZCxcbiAgICB0b2dnbGVSb3c6IGNvbnN0Vm9pZCxcbiAgICBhbGxSb3dzQ2hlY2tlZDogY29tcHV0ZWQoY29uc3RGYWxzZSksXG4gICAgYWxsUm93c1VuY2hlY2thYmxlOiBjb21wdXRlZChjb25zdEZhbHNlKSxcbiAgICBoYXNDaGVja2FibGVSb3dzOiBjb21wdXRlZChjb25zdEZhbHNlKSxcbiAgICBhbGxSb3dzVW5jaGVja2VkOiBjb21wdXRlZChjb25zdFRydWUpXG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VJbmplY3RlZENoZWNrYWJsZVRhYmxlKCk6IFVzZUNoZWNrYWJsZVRhYmxlIHtcbiAgcmV0dXJuIGluamVjdChVU0VfQ0hFQ0tBQkxFX1RBQkxFX0lOSkVDVElPTl9TWU1CT0wsIHVzZURlZmF1bHRDaGVja2FibGVUYWJsZVN0YXRlLCB0cnVlKTtcbn1cbiJdfQ==