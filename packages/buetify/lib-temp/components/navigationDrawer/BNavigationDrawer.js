import './navigation-drawer.sass';
import { identity, pipe } from 'fp-ts/lib/function';
import { exists } from 'fp-ts/lib/Option';
import { useNavigationDrawerController } from '../../composables/navigationDrawerController';
import { useThemePropsDefinition, useTheme } from '../../composables/theme';
import { useWindowSize } from '../../composables/windowSize';
import { SlideRightTransition } from '../../transitions/slideRightTransition';
import { defineComponent, h, computed, watchEffect, watch, toRef, withDirectives, vShow } from 'vue';
import BOverlay from '../overlay/BOverlay';
import { NavigationDrawerThemeMap } from './theme';
export const BNavigationDrawerPropsDefinition = {
    ...useThemePropsDefinition(NavigationDrawerThemeMap),
    tag: {
        type: String,
        default: 'nav'
    },
    isFullheight: {
        type: Boolean,
        default: true
    },
    currentRoute: {
        type: Object,
        required: false
    }
};
function generateDrawer(props, controller, themeClasses, context) {
    return h(props.tag, {
        class: ['b-navigation-drawer', { 'is-fullheight': props.isFullheight }, ...themeClasses]
    }, context.slots.default &&
        context.slots.default({
            showNavigationDrawer: controller.show,
            hideNavigationDrawer: controller.hide,
            navigationDrawerIsVisible: controller.isVisible.value,
            toggleNavigationDrawer: controller.toggle
        }));
}
function generateMobileDrawer(props, controller, themeClasses, context) {
    return h(SlideRightTransition, undefined, () => withDirectives(h(BOverlay, {
        class: 'is-left',
        isActive: pipe(controller.isVisible.value, exists(identity)),
        onClick: controller.hide
    }, () => generateDrawer(props, controller, themeClasses, context)), [[vShow, controller.isVisible.value]]));
}
export default defineComponent({
    name: 'b-navigation-drawer',
    props: BNavigationDrawerPropsDefinition,
    setup(props, context) {
        const controller = useNavigationDrawerController();
        const windowSize = useWindowSize();
        const { themeClasses } = useTheme(props);
        const useSideDrawer = computed(() => {
            return windowSize.value.isTouch || windowSize.value.isDesktop;
        });
        watchEffect(() => {
            useSideDrawer.value ? controller.hide() : controller.show();
        });
        watch(toRef(props, 'currentRoute'), newVal => {
            if (useSideDrawer.value) {
                controller.hide();
            }
        });
        return () => {
            if (useSideDrawer.value) {
                return generateMobileDrawer(props, controller, themeClasses.value, context);
            }
            else {
                return generateDrawer(props, controller, themeClasses.value, context);
            }
        };
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQk5hdmlnYXRpb25EcmF3ZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvY29tcG9uZW50cy9uYXZpZ2F0aW9uRHJhd2VyL0JOYXZpZ2F0aW9uRHJhd2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sMEJBQTBCLENBQUM7QUFDbEMsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUNwRCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDMUMsT0FBTyxFQUVMLDZCQUE2QixFQUM5QixNQUFNLDhDQUE4QyxDQUFDO0FBQ3RELE9BQU8sRUFBRSx1QkFBdUIsRUFBRSxRQUFRLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUM1RSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDN0QsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sd0NBQXdDLENBQUM7QUFDOUUsT0FBTyxFQUNMLGVBQWUsRUFHZixDQUFDLEVBRUQsUUFBUSxFQUNSLFdBQVcsRUFDWCxLQUFLLEVBQ0wsS0FBSyxFQUVMLGNBQWMsRUFDZCxLQUFLLEVBQ04sTUFBTSxLQUFLLENBQUM7QUFDYixPQUFPLFFBQVEsTUFBTSxxQkFBcUIsQ0FBQztBQUMzQyxPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSxTQUFTLENBQUM7QUFFbkQsTUFBTSxDQUFDLE1BQU0sZ0NBQWdDLEdBQUc7SUFDOUMsR0FBRyx1QkFBdUIsQ0FBQyx3QkFBd0IsQ0FBQztJQUNwRCxHQUFHLEVBQUU7UUFDSCxJQUFJLEVBQUUsTUFBMEI7UUFDaEMsT0FBTyxFQUFFLEtBQUs7S0FDZjtJQUNELFlBQVksRUFBRTtRQUNaLElBQUksRUFBRSxPQUE0QjtRQUNsQyxPQUFPLEVBQUUsSUFBSTtLQUNkO0lBQ0QsWUFBWSxFQUFFO1FBQ1osSUFBSSxFQUFFLE1BQTBCO1FBQ2hDLFFBQVEsRUFBRSxLQUFL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SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICcuL25hdmlnYXRpb24tZHJhd2VyLnNhc3MnO1xuaW1wb3J0IHsgaWRlbnRpdHksIHBpcGUgfSBmcm9tICdmcC10cy9saWIvZnVuY3Rpb24nO1xuaW1wb3J0IHsgZXhpc3RzIH0gZnJvbSAnZnAtdHMvbGliL09wdGlvbic7XG5pbXBvcnQge1xuICBOYXZpZ2F0aW9uRHJhd2VyQ29udHJvbGxlcixcbiAgdXNlTmF2aWdhdGlvbkRyYXdlckNvbnRyb2xsZXJcbn0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZXMvbmF2aWdhdGlvbkRyYXdlckNvbnRyb2xsZXInO1xuaW1wb3J0IHsgdXNlVGhlbWVQcm9wc0RlZmluaXRpb24sIHVzZVRoZW1lIH0gZnJvbSAnLi4vLi4vY29tcG9zYWJsZXMvdGhlbWUnO1xuaW1wb3J0IHsgdXNlV2luZG93U2l6ZSB9IGZyb20gJy4uLy4uL2NvbXBvc2FibGVzL3dpbmRvd1NpemUnO1xuaW1wb3J0IHsgU2xpZGVSaWdodFRyYW5zaXRpb24gfSBmcm9tICcuLi8uLi90cmFuc2l0aW9ucy9zbGlkZVJpZ2h0VHJhbnNpdGlvbic7XG5pbXBvcnQge1xuICBkZWZpbmVDb21wb25lbnQsXG4gIFNldHVwQ29udGV4dCxcbiAgVk5vZGUsXG4gIGgsXG4gIFByb3BUeXBlLFxuICBjb21wdXRlZCxcbiAgd2F0Y2hFZmZlY3QsXG4gIHdhdGNoLFxuICB0b1JlZixcbiAgRXh0cmFjdFByb3BUeXBlcyxcbiAgd2l0aERpcmVjdGl2ZXMsXG4gIHZTaG93XG59IGZyb20gJ3Z1ZSc7XG5pbXBvcnQgQk92ZXJsYXkgZnJvbSAnLi4vb3ZlcmxheS9CT3ZlcmxheSc7XG5pbXBvcnQgeyBOYXZpZ2F0aW9uRHJhd2VyVGhlbWVNYXAgfSBmcm9tICcuL3RoZW1lJztcblxuZXhwb3J0IGNvbnN0IEJOYXZpZ2F0aW9uRHJhd2VyUHJvcHNEZWZpbml0aW9uID0ge1xuICAuLi51c2VUaGVtZVByb3BzRGVmaW5pdGlvbihOYXZpZ2F0aW9uRHJhd2VyVGhlbWVNYXApLFxuICB0YWc6IHtcbiAgICB0eXBlOiBTdHJpbmcgYXMgUHJvcFR5cGU8c3RyaW5nPixcbiAgICBkZWZhdWx0OiAnbmF2J1xuICB9LFxuICBpc0Z1bGxoZWlnaHQ6IHtcbiAgICB0eXBlOiBCb29sZWFuIGFzIFByb3BUeXBlPGJvb2xlYW4+LFxuICAgIGRlZmF1bHQ6IHRydWVcbiAgfSxcbiAgY3VycmVudFJvdXRlOiB7XG4gICAgdHlwZTogT2JqZWN0IGFzIFByb3BUeXBlPG9iamVjdD4sXG4gICAgcmVxdWlyZWQ6IGZhbHNlXG4gIH1cbn07XG5cbmV4cG9ydCB0eXBlIEJOYXZpZ2F0aW9uRHJhd2VyUHJvcHMgPSBFeHRyYWN0UHJvcFR5cGVzPHR5cGVvZiBCTmF2aWdhdGlvbkRyYXdlclByb3BzRGVmaW5pdGlvbj47XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRHJhd2VyKFxuICBwcm9wczogQk5hdmlnYXRpb25EcmF3ZXJQcm9wcyxcbiAgY29udHJvbGxlcjogTmF2aWdhdGlvbkRyYXdlckNvbnRyb2xsZXIsXG4gIHRoZW1lQ2xhc3Nlczogc3RyaW5nW10sXG4gIGNvbnRleHQ6IFNldHVwQ29udGV4dFxuKTogVk5vZGUge1xuICByZXR1cm4gaChcbiAgICBwcm9wcy50YWcsXG4gICAge1xuICAgICAgY2xhc3M6IFsnYi1uYXZpZ2F0aW9uLWRyYXdlcicsIHsgJ2lzLWZ1bGxoZWlnaHQnOiBwcm9wcy5pc0Z1bGxoZWlnaHQgfSwgLi4udGhlbWVDbGFzc2VzXVxuICAgIH0sXG4gICAgY29udGV4dC5zbG90cy5kZWZhdWx0ICYmXG4gICAgICBjb250ZXh0LnNsb3RzLmRlZmF1bHQoe1xuICAgICAgICBzaG93TmF2aWdhdGlvbkRyYXdlcjogY29udHJvbGxlci5zaG93LFxuICAgICAgICBoaWRlTmF2aWdhdGlvbkRyYXdlcjogY29udHJvbGxlci5oaWRlLFxuICAgICAgICBuYXZpZ2F0aW9uRHJhd2VySXNWaXNpYmxlOiBjb250cm9sbGVyLmlzVmlzaWJsZS52YWx1ZSxcbiAgICAgICAgdG9nZ2xlTmF2aWdhdGlvbkRyYXdlcjogY29udHJvbGxlci50b2dnbGVcbiAgICAgIH0pXG4gICk7XG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlTW9iaWxlRHJhd2VyKFxuICBwcm9wczogQk5hdmlnYXRpb25EcmF3ZXJQcm9wcyxcbiAgY29udHJvbGxlcjogTmF2aWdhdGlvbkRyYXdlckNvbnRyb2xsZXIsXG4gIHRoZW1lQ2xhc3Nlczogc3RyaW5nW10sXG4gIGNvbnRleHQ6IFNldHVwQ29udGV4dFxuKTogVk5vZGUge1xuICByZXR1cm4gaChTbGlkZVJpZ2h0VHJhbnNpdGlvbiwgdW5kZWZpbmVkLCAoKSA9PlxuICAgIHdpdGhEaXJlY3RpdmVzKFxuICAgICAgaChcbiAgICAgICAgQk92ZXJsYXksXG4gICAgICAgIHtcbiAgICAgICAgICBjbGFzczogJ2lzLWxlZnQnLFxuICAgICAgICAgIGlzQWN0aXZlOiBwaXBlKGNvbnRyb2xsZXIuaXNWaXNpYmxlLnZhbHVlLCBleGlzdHMoaWRlbnRpdHkpKSxcbiAgICAgICAgICBvbkNsaWNrOiBjb250cm9sbGVyLmhpZGVcbiAgICAgICAgfSxcbiAgICAgICAgKCkgPT4gZ2VuZXJhdGVEcmF3ZXIocHJvcHMsIGNvbnRyb2xsZXIsIHRoZW1lQ2xhc3NlcywgY29udGV4dClcbiAgICAgICksXG4gICAgICBbW3ZTaG93LCBjb250cm9sbGVyLmlzVmlzaWJsZS52YWx1ZV1dXG4gICAgKVxuICApO1xufVxuXG5leHBvcnQgZGVmYXVsdCBkZWZpbmVDb21wb25lbnQoe1xuICBuYW1lOiAnYi1uYXZpZ2F0aW9uLWRyYXdlcicsXG4gIHByb3BzOiBCTmF2aWdhdGlvbkRyYXdlclByb3BzRGVmaW5pdGlvbixcbiAgc2V0dXAocHJvcHMsIGNvbnRleHQpIHtcbiAgICBjb25zdCBjb250cm9sbGVyID0gdXNlTmF2aWdhdGlvbkRyYXdlckNvbnRyb2xsZXIoKTtcbiAgICBjb25zdCB3aW5kb3dTaXplID0gdXNlV2luZG93U2l6ZSgpO1xuICAgIGNvbnN0IHsgdGhlbWVDbGFzc2VzIH0gPSB1c2VUaGVtZShwcm9wcyk7XG4gICAgY29uc3QgdXNlU2lkZURyYXdlciA9IGNvbXB1dGVkKCgpID0+IHtcbiAgICAgIHJldHVybiB3aW5kb3dTaXplLnZhbHVlLmlzVG91Y2ggfHwgd2luZG93U2l6ZS52YWx1ZS5pc0Rlc2t0b3A7XG4gICAgfSk7XG4gICAgd2F0Y2hFZmZlY3QoKCkgPT4ge1xuICAgICAgdXNlU2lkZURyYXdlci52YWx1ZSA/IGNvbnRyb2xsZXIuaGlkZSgpIDogY29udHJvbGxlci5zaG93KCk7XG4gICAgfSk7XG4gICAgd2F0Y2godG9SZWYocHJvcHMsICdjdXJyZW50Um91dGUnKSwgbmV3VmFsID0+IHtcbiAgICAgIGlmICh1c2VTaWRlRHJhd2VyLnZhbHVlKSB7XG4gICAgICAgIGNvbnRyb2xsZXIuaGlkZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBpZiAodXNlU2lkZURyYXdlci52YWx1ZSkge1xuICAgICAgICByZXR1cm4gZ2VuZXJhdGVNb2JpbGVEcmF3ZXIocHJvcHMsIGNvbnRyb2xsZXIsIHRoZW1lQ2xhc3Nlcy52YWx1ZSwgY29udGV4dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZ2VuZXJhdGVEcmF3ZXIocHJvcHMsIGNvbnRyb2xsZXIsIHRoZW1lQ2xhc3Nlcy52YWx1ZSwgY29udGV4dCk7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSk7XG4iXX0=