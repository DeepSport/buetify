import './modal.sass';
import { usePopupController, UsePopupControllerPropsDefinition } from '../../composables/popupController';
import { constEmptyArray } from '../../utils/helpers';
import BOverlay from '../overlay/BOverlay';
import BBox from '../layout/box/BBox';
import { defineComponent, shallowRef, h } from 'vue';
const BModalPropsDefinition = {
    ...UsePopupControllerPropsDefinition,
    showExit: {
        type: Boolean,
        required: false,
        default: false
    }
};
function generateCloseButton(close) {
    return h('button', {
        class: 'modal-exit delete is-small',
        onClick: close
    });
}
function generateModalBox(props, context, controller) {
    return h(BBox, {
        class: 'is-paddingless is-fullheight is-fullwidth overflow-scroll'
    }, () => [
        h('div', { class: 'is-fullheight' }, () => props.showExit ? [generateCloseButton(controller.close), context.slots.default()] : context.slots.default())
    ]);
}
export default defineComponent({
    name: 'b-modal',
    props: BModalPropsDefinition,
    setup(props, context) {
        const generateModal = shallowRef(constEmptyArray);
        const popup = usePopupController(props, generateModal);
        generateModal.value = () => {
            return [
                h(BOverlay, {
                    ...context.attrs,
                    onClick: popup.close
                }, () => [generateModalBox(props, context, popup)])
            ];
        };
        return { popup };
    },
    render() {
        return this.$slots.trigger && this.$slots.trigger(this.popup);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQk1vZGFsLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvbW9kYWwvQk1vZGFsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sY0FBYyxDQUFDO0FBRXRCLE9BQU8sRUFFTCxrQkFBa0IsRUFDbEIsaUNBQWlDLEVBQ2xDLE1BQU0sbUNBQW1DLENBQUM7QUFDM0MsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ3RELE9BQU8sUUFBUSxNQUFNLHFCQUFxQixDQUFDO0FBQzNDLE9BQU8sSUFBSSxNQUFNLG9CQUFvQixDQUFDO0FBQ3RDLE9BQU8sRUFBUyxlQUFlLEVBQTBCLFVBQVUsRUFBRSxDQUFDLEVBQW9CLE1BQU0sS0FBSyxDQUFDO0FBRXRHLE1BQU0scUJBQXFCLEdBQUc7SUFDNUIsR0FBRyxpQ0FBaUM7SUFDcEMsUUFBUSxFQUFFO1FBQ1IsSUFBSSxFQUFFLE9BQTRCO1FBQ2xDLFFBQVEsRUFBRSxLQUFLO1FBQ2YsT0FBTyxFQUFFLEtBQUs7S0FDZjtDQUNGLENBQUM7QUFJRixTQUFTLG1CQUFtQixDQUFDLEtBQWU7SUFDMUMsT0FBTyxDQUFDLENBQUMsUUFBUSxFQUFFO1FBQ2pCLEtBQUssRUFBRSw0QkFBNEI7UUFDbkMsT0FBTyxFQUFFLEtBQUs7S0FDZixDQUFDLENBQUM7QUFDTCxDQUFDO0FBRUQsU0FBUyxnQkFBZ0IsQ0FBQyxLQUFrQixFQUFFLE9BQXFCLEVBQUUsVUFBMkI7SUFDOUYsT0FBTyxDQUFDLENBQ04sSUFBSSxFQUNKO1FBQ0UsS0FBSyxFQUFFLDJEQUEyRDtLQUNuRSxFQUNELEdBQUcsRUFBRSxDQUFDO1FBQ0osQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLEtBQUssRUFBRSxlQUFlLEVBQUUsRUFBRSxHQUFHLEVBQUUsQ0FDeEMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxtQkFBbUIsQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxPQUFRLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLE9BQVEsRUFBRSxDQUM5RztLQUNGLENBQ0YsQ0FBQztBQUNKLENBQUM7QUFFRCxlQUFlLGVBQWUsQ0FBQztJQUM3QixJQUFJLEVBQUUsU0FBUztJQUNmLEtBQUssRUFBRSxxQkFBcUI7SUFDNUIsS0FBSyxDQUFDLEtBQUssRUFBRSxPQUFPO1FBQ2xCLE1BQU0sYUFBYSxHQUFHLFVBQVUsQ0FBQyxlQUE4QixDQUFDLENBQUM7UUFDakUsTUFBTSxLQUFLLEdBQUcsa0JBQWtCLENBQUMsS0FBSyxFQUFFLGFBQWEsQ0FBQyxDQUFDO1FBQ3ZELGFBQWEsQ0FBQyxLQUFLLEdBQUcsR0FBRyxFQUFFO1lBQ3pCLE9BQU87Z0JBQ0wsQ0FBQyxDQUNDLFFBQVEsRUFDUjtvQkFDRSxHQUFHLE9BQU8sQ0FBQyxLQUFLO29CQUNoQixPQUFPLEVBQUUsS0FBSyxDQUFDLEtBQUs7aUJBQ3JCLEVBQ0QsR0FBRyxFQUFFLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQ2hEO2FBQ0YsQ0FBQztRQUNKLENBQUMsQ0FBQztRQUNGLE9BQU8sRUFBRSxLQUFLLEVBQUUsQ0FBQztJQUNuQixDQUFDO0lBQ0QsTUFBTTtRQUNKLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hFLENBQUM7Q0FDRixDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJy4vbW9kYWwuc2Fzcyc7XG5pbXBvcnQgeyBJTyB9IGZyb20gJ2ZwLXRzL2xpYi9JTyc7XG5pbXBvcnQge1xuICBQb3B1cENvbnRyb2xsZXIsXG4gIHVzZVBvcHVwQ29udHJvbGxlcixcbiAgVXNlUG9wdXBDb250cm9sbGVyUHJvcHNEZWZpbml0aW9uXG59IGZyb20gJy4uLy4uL2NvbXBvc2FibGVzL3BvcHVwQ29udHJvbGxlcic7XG5pbXBvcnQgeyBjb25zdEVtcHR5QXJyYXkgfSBmcm9tICcuLi8uLi91dGlscy9oZWxwZXJzJztcbmltcG9ydCBCT3ZlcmxheSBmcm9tICcuLi9vdmVybGF5L0JPdmVybGF5JztcbmltcG9ydCBCQm94IGZyb20gJy4uL2xheW91dC9ib3gvQkJveCc7XG5pbXBvcnQgeyBWTm9kZSwgZGVmaW5lQ29tcG9uZW50LCBQcm9wVHlwZSwgU2V0dXBDb250ZXh0LCBzaGFsbG93UmVmLCBoLCBFeHRyYWN0UHJvcFR5cGVzIH0gZnJvbSAndnVlJztcblxuY29uc3QgQk1vZGFsUHJvcHNEZWZpbml0aW9uID0ge1xuICAuLi5Vc2VQb3B1cENvbnRyb2xsZXJQcm9wc0RlZmluaXRpb24sXG4gIHNob3dFeGl0OiB7XG4gICAgdHlwZTogQm9vbGVhbiBhcyBQcm9wVHlwZTxib29sZWFuPixcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgZGVmYXVsdDogZmFsc2VcbiAgfVxufTtcblxuZXhwb3J0IHR5cGUgQk1vZGFsUHJvcHMgPSBFeHRyYWN0UHJvcFR5cGVzPHR5cGVvZiBCTW9kYWxQcm9wc0RlZmluaXRpb24+O1xuXG5mdW5jdGlvbiBnZW5lcmF0ZUNsb3NlQnV0dG9uKGNsb3NlOiBJTzx2b2lkPik6IFZOb2RlIHtcbiAgcmV0dXJuIGgoJ2J1dHRvbicsIHtcbiAgICBjbGFzczogJ21vZGFsLWV4aXQgZGVsZXRlIGlzLXNtYWxsJyxcbiAgICBvbkNsaWNrOiBjbG9zZVxuICB9KTtcbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVNb2RhbEJveChwcm9wczogQk1vZGFsUHJvcHMsIGNvbnRleHQ6IFNldHVwQ29udGV4dCwgY29udHJvbGxlcjogUG9wdXBDb250cm9sbGVyKTogVk5vZGUge1xuICByZXR1cm4gaChcbiAgICBCQm94LFxuICAgIHtcbiAgICAgIGNsYXNzOiAnaXMtcGFkZGluZ2xlc3MgaXMtZnVsbGhlaWdodCBpcy1mdWxsd2lkdGggb3ZlcmZsb3ctc2Nyb2xsJ1xuICAgIH0sXG4gICAgKCkgPT4gW1xuICAgICAgaCgnZGl2JywgeyBjbGFzczogJ2lzLWZ1bGxoZWlnaHQnIH0sICgpID0+XG4gICAgICAgIHByb3BzLnNob3dFeGl0ID8gW2dlbmVyYXRlQ2xvc2VCdXR0b24oY29udHJvbGxlci5jbG9zZSksIGNvbnRleHQuc2xvdHMuZGVmYXVsdCEoKV0gOiBjb250ZXh0LnNsb3RzLmRlZmF1bHQhKClcbiAgICAgIClcbiAgICBdXG4gICk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGRlZmluZUNvbXBvbmVudCh7XG4gIG5hbWU6ICdiLW1vZGFsJyxcbiAgcHJvcHM6IEJNb2RhbFByb3BzRGVmaW5pdGlvbixcbiAgc2V0dXAocHJvcHMsIGNvbnRleHQpIHtcbiAgICBjb25zdCBnZW5lcmF0ZU1vZGFsID0gc2hhbGxvd1JlZihjb25zdEVtcHR5QXJyYXkgYXMgSU88Vk5vZGVbXT4pO1xuICAgIGNvbnN0IHBvcHVwID0gdXNlUG9wdXBDb250cm9sbGVyKHByb3BzLCBnZW5lcmF0ZU1vZGFsKTtcbiAgICBnZW5lcmF0ZU1vZGFsLnZhbHVlID0gKCkgPT4ge1xuICAgICAgcmV0dXJuIFtcbiAgICAgICAgaChcbiAgICAgICAgICBCT3ZlcmxheSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICAuLi5jb250ZXh0LmF0dHJzLFxuICAgICAgICAgICAgb25DbGljazogcG9wdXAuY2xvc2VcbiAgICAgICAgICB9LFxuICAgICAgICAgICgpID0+IFtnZW5lcmF0ZU1vZGFsQm94KHByb3BzLCBjb250ZXh0LCBwb3B1cCldXG4gICAgICAgIClcbiAgICAgIF07XG4gICAgfTtcbiAgICByZXR1cm4geyBwb3B1cCB9O1xuICB9LFxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuJHNsb3RzLnRyaWdnZXIgJiYgdGhpcy4kc2xvdHMudHJpZ2dlcih0aGlzLnBvcHVwKTtcbiAgfVxufSk7XG4iXX0=